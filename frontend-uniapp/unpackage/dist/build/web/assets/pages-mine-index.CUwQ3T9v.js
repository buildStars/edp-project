import{r as a,u as e,z as s,o as l,g as c,a3 as t,b as o,s as i,c as n,w as r,i as d,d as u,e as f,H as _,k as m,v as g,t as p,f as v,n as k,l as y,m as z,N as b,a4 as w,q as C,p as h,T as x}from"./index-BA-OeFd4.js";import{u as L}from"./course.CVoECnYr.js";import{g as F}from"./notification.fuGCRGQF.js";/* empty css                                                                    */import{_ as j}from"./_plugin-vue_export-helper.BCo6x5W8.js";/* empty css                                                                   */import{I as B}from"./icon.DZSIreks.js";const O=j({__name:"index",setup(j){const O=a(0),I=e(),T=L(),D=s((()=>I.userInfo||{})),$=a({}),A=a(0),H=s((()=>D.value.adminOrganizations&&D.value.adminOrganizations.length>0)),N=s((()=>!!D.value.organizationId)),q=s((()=>H.value&&D.value.adminOrganizations&&D.value.adminOrganizations.length>0?D.value.adminOrganizations[0].name:N.value&&D.value.organization?D.value.organization.name:"")),E=a("enrolled");a([{label:"我的课程",value:"enrolled"},{label:"已上课程",value:"completed"}]),s((()=>"enrolled"===E.value?T.myCourses.enrolled:T.myCourses.completed)),l((()=>{const a=c();O.value=a.statusBarHeight||0,I.isLogin&&M()})),t((()=>{I.isLogin&&M()}));const M=async()=>{try{await I.fetchUserInfo();const a=await I.fetchCredits();$.value=a||{},await T.fetchMyCourses("enrolled"),await T.fetchMyCourses("completed"),P()}catch(a){console.error("加载用户数据失败：",a)}},P=async()=>{try{const a=await F();A.value=a.count||0}catch(a){console.error("获取未读消息数量失败：",a)}},G=()=>{y({url:"/pages/login/index"})},J=()=>{y({url:"/pages/mine/edit-info"})},R=()=>{y({url:"/pages/mine/my-credits"})},S=()=>{y({url:"/pages/checkin/records"})},U=()=>{y({url:"/pages/mine/my-courses"})},K=()=>{y({url:"/pages/mine/my-collection"})},Q=()=>{y({url:"/pages/mine/messages"})},V=()=>{y({url:"/pages/corporate/employees"})},W=()=>{const a=H.value?D.value.adminOrganizations[0]:D.value.organization;if(!a)return void z({title:"暂无企业信息",icon:"none"});const e=[`企业名称：${a.name}`,`可上课人数：${a.maxStudents||0}人`,`总学分：${a.totalCredits||0}`,`已使用学分：${a.usedCredits||0}`,"剩余学分："+((a.totalCredits||0)-(a.usedCredits||0))].join("\n");b({title:"企业信息",content:e,showCancel:!1,confirmText:"知道了"})},X=()=>{y({url:"/pages/mine/download-list"})},Y=()=>{y({url:"/pages/ai-report/index"})},Z=()=>{b({title:"联系客服",content:"客服电话：40077-20111",confirmText:"拨打电话",success:a=>{a.confirm&&w({phoneNumber:"40077-20111"})}})},aa=()=>{y({url:"/pages/about/index"})},ea=()=>{b({title:"提示",content:"确定要退出登录吗？",success:a=>{a.confirm&&I.logout()}})};return o((()=>{I.isLogin?M().then((()=>{i()})):i()})),(a,e)=>{const s=d,l=C,c=h,t=x;return u(),n(s,{class:"page"},{default:r((()=>[f(s,{class:"user-section",style:k({paddingTop:O.value+"px"})},{default:r((()=>[f(s,{class:"bg-decoration"},{default:r((()=>[f(s,{class:"decoration-circle circle-1"}),f(s,{class:"decoration-circle circle-2"}),f(s,{class:"decoration-circle circle-3"})])),_:1}),_(I).isLogin?(u(),n(s,{key:1,class:"user-info"},{default:r((()=>[f(s,{class:"avatar-wrapper"},{default:r((()=>[f(c,{src:_(I).avatar,class:"avatar"},null,8,["src"]),f(s,{class:"avatar-glow"}),f(s,{class:"avatar-decoration"}),H.value||N.value?(u(),n(s,{key:0,class:g(["user-badge",{"badge-admin":H.value,"badge-user":N.value&&!H.value}])},{default:r((()=>[f(l,{class:"badge-text"},{default:r((()=>[m(p(H.value?"企业管理员":"企业用户"),1)])),_:1})])),_:1},8,["class"])):v("",!0)])),_:1}),f(s,{class:"user-detail"},{default:r((()=>[f(s,{class:"user-name-row"},{default:r((()=>[f(l,{class:"user-name"},{default:r((()=>[m(p(_(I).nickname),1)])),_:1}),q.value?(u(),n(s,{key:0,class:"org-tag"},{default:r((()=>[f(B,{name:"work",size:24,color:"#fff"}),f(l,{class:"org-name"},{default:r((()=>[m(p(q.value),1)])),_:1})])),_:1})):v("",!0)])),_:1}),D.value.company?(u(),n(s,{key:0,class:"user-company"},{default:r((()=>[f(B,{name:"work",size:28,color:"rgba(255, 255, 255, 0.8)"}),f(l,null,{default:r((()=>[m(p(D.value.company)+" "+p(D.value.position?"·"+D.value.position:""),1)])),_:1})])),_:1})):v("",!0)])),_:1}),f(s,{class:"edit-btn",onClick:J},{default:r((()=>[f(B,{name:"edit",size:40,color:"#fff"})])),_:1})])),_:1})):(u(),n(s,{key:0,class:"login-prompt",onClick:G},{default:r((()=>[f(s,{class:"avatar-wrapper"},{default:r((()=>[f(B,{name:"user",size:120,class:"avatar"}),f(s,{class:"avatar-glow"})])),_:1}),f(s,{class:"login-text"},{default:r((()=>[f(l,{class:"login-title"},{default:r((()=>[m("欢迎来到EDP")])),_:1}),f(l,{class:"login-subtitle"},{default:r((()=>[m("点击登录 · 开启学习之旅")])),_:1})])),_:1}),f(B,{name:"arrow-right",size:48,color:"rgba(255, 255, 255, 0.8)"})])),_:1})),_(I).isLogin?(u(),n(s,{key:2,class:"credit-card"},{default:r((()=>[f(s,{class:"credit-item",onClick:R},{default:r((()=>[f(s,{class:"credit-icon"},{default:r((()=>[f(B,{name:"star",size:48,color:"#FFD700"})])),_:1}),f(s,{class:"credit-content"},{default:r((()=>[f(s,{class:"credit-value"},{default:r((()=>[m(p($.value.balance||0),1)])),_:1}),f(s,{class:"credit-label"},{default:r((()=>[m("总学分")])),_:1})])),_:1})])),_:1}),f(s,{class:"credit-divider"}),f(s,{class:"credit-item"},{default:r((()=>[f(s,{class:"credit-icon"},{default:r((()=>[f(B,{name:"user",size:48,color:"#52C41A"})])),_:1}),f(s,{class:"credit-content"},{default:r((()=>[f(s,{class:"credit-value"},{default:r((()=>[m(p($.value.personalBalance||0),1)])),_:1}),f(s,{class:"credit-label"},{default:r((()=>[m("个人学分")])),_:1}),f(s,{class:"credit-tip"},{default:r((()=>[m("可赠课")])),_:1})])),_:1})])),_:1}),f(s,{class:"credit-divider"}),f(s,{class:"credit-item"},{default:r((()=>[f(s,{class:"credit-icon"},{default:r((()=>[f(B,{name:"work",size:48,color:"#FF6B6B"})])),_:1}),f(s,{class:"credit-content"},{default:r((()=>[f(s,{class:"credit-value"},{default:r((()=>[m(p($.value.lockedBalance||0),1)])),_:1}),f(s,{class:"credit-label"},{default:r((()=>[m("锁定学分")])),_:1}),f(s,{class:"credit-tip"},{default:r((()=>[m("只能购课")])),_:1})])),_:1})])),_:1})])),_:1})):v("",!0)])),_:1},8,["style"]),f(s,{class:"menu-section"},{default:r((()=>[f(s,{class:"menu-grid"},{default:r((()=>[_(I).isLogin?(u(),n(s,{key:0,class:"menu-card",onClick:U},{default:r((()=>[f(s,{class:"menu-icon-wrapper gradient-blue"},{default:r((()=>[f(B,{name:"course",size:56,color:"#fff"})])),_:1}),f(l,{class:"menu-label"},{default:r((()=>[m("我的课程")])),_:1})])),_:1})):v("",!0),_(I).isLogin?(u(),n(s,{key:1,class:"menu-card",onClick:K},{default:r((()=>[f(s,{class:"menu-icon-wrapper gradient-red"},{default:r((()=>[f(B,{name:"star",size:56,color:"#fff"})])),_:1}),f(l,{class:"menu-label"},{default:r((()=>[m("我的收藏")])),_:1})])),_:1})):v("",!0),_(I).isLogin?(u(),n(s,{key:2,class:"menu-card",onClick:Q},{default:r((()=>[f(s,{class:"menu-icon-wrapper gradient-purple"},{default:r((()=>[f(B,{name:"message",size:56,color:"#fff"}),A.value>0?(u(),n(s,{key:0,class:"icon-badge"},{default:r((()=>[m(p(A.value>99?"99+":A.value),1)])),_:1})):v("",!0)])),_:1}),f(l,{class:"menu-label"},{default:r((()=>[m("消息中心")])),_:1})])),_:1})):v("",!0),_(I).isLogin?(u(),n(s,{key:3,class:"menu-card",onClick:X},{default:r((()=>[f(s,{class:"menu-icon-wrapper gradient-green"},{default:r((()=>[f(B,{name:"download",size:56,color:"#fff"})])),_:1}),f(l,{class:"menu-label"},{default:r((()=>[m("课件下载")])),_:1})])),_:1})):v("",!0)])),_:1})])),_:1}),_(I).isLogin&&(H.value||N.value)?(u(),n(s,{key:0,class:"corp-section"},{default:r((()=>[f(s,{class:"section-header"},{default:r((()=>[f(s,{class:"header-left"},{default:r((()=>[f(B,{name:"work",size:40,color:"#9C27B0"}),f(l,{class:"section-title"},{default:r((()=>[m("企业功能")])),_:1})])),_:1}),q.value?(u(),n(s,{key:0,class:"org-info"},{default:r((()=>[f(l,{class:"org-name-text"},{default:r((()=>[m(p(q.value),1)])),_:1})])),_:1})):v("",!0)])),_:1}),f(s,{class:"corp-cards"},{default:r((()=>[H.value?(u(),n(s,{key:0,class:"corp-card admin-card",onClick:V},{default:r((()=>[f(s,{class:"card-header"},{default:r((()=>[f(s,{class:"card-icon gradient-purple"},{default:r((()=>[f(B,{name:"teacher",size:52,color:"#fff"})])),_:1}),f(s,{class:"card-badge"},{default:r((()=>[m("管理员")])),_:1})])),_:1}),f(s,{class:"card-content"},{default:r((()=>[f(l,{class:"card-title"},{default:r((()=>[m("员工管理")])),_:1}),f(l,{class:"card-desc"},{default:r((()=>[m("分配学分 · 购买课程 · 员工管理")])),_:1})])),_:1}),f(s,{class:"card-footer"},{default:r((()=>[f(l,{class:"card-link"},{default:r((()=>[m("立即管理")])),_:1}),f(B,{name:"arrow-right",size:28,color:"#9C27B0"})])),_:1})])),_:1})):v("",!0),N.value?(u(),n(s,{key:1,class:"corp-card user-card",onClick:W},{default:r((()=>[f(s,{class:"card-header"},{default:r((()=>[f(s,{class:"card-icon gradient-blue"},{default:r((()=>[f(B,{name:"user",size:52,color:"#fff"})])),_:1}),f(s,{class:"card-badge"},{default:r((()=>[m("企业用户")])),_:1})])),_:1}),f(s,{class:"card-content"},{default:r((()=>[f(l,{class:"card-title"},{default:r((()=>[m("我的企业")])),_:1}),f(l,{class:"card-desc"},{default:r((()=>[m(p(q.value||"暂无企业信息"),1)])),_:1})])),_:1}),f(s,{class:"card-footer"},{default:r((()=>[f(l,{class:"card-link"},{default:r((()=>[m("查看详情")])),_:1}),f(B,{name:"arrow-right",size:28,color:"#1890FF"})])),_:1})])),_:1})):v("",!0)])),_:1})])),_:1})):v("",!0),f(s,{class:"quick-actions"},{default:r((()=>[_(I).isLogin?(u(),n(s,{key:0,class:"action-item",onClick:S},{default:r((()=>[f(s,{class:"action-icon"},{default:r((()=>[f(B,{name:"check",size:44,color:"#52C41A"})])),_:1}),f(s,{class:"action-content"},{default:r((()=>[f(l,{class:"action-title"},{default:r((()=>[m("签到记录")])),_:1}),f(l,{class:"action-desc"},{default:r((()=>[m("查看我的签到统计")])),_:1})])),_:1}),f(B,{name:"arrow-right",size:32,color:"#ccc"})])),_:1})):v("",!0),_(I).isLogin?(u(),n(s,{key:1,class:"action-item",onClick:Y},{default:r((()=>[f(s,{class:"action-icon"},{default:r((()=>[f(B,{name:"ai",size:44,color:"#1890FF"})])),_:1}),f(s,{class:"action-content"},{default:r((()=>[f(l,{class:"action-title"},{default:r((()=>[m("AI报告")])),_:1}),f(l,{class:"action-desc"},{default:r((()=>[m("智能分析您的学习情况")])),_:1})])),_:1}),f(s,{class:"action-badge"},{default:r((()=>[m("HOT")])),_:1}),f(B,{name:"arrow-right",size:32,color:"#ccc"})])),_:1})):v("",!0),f(s,{class:"action-item",onClick:Z},{default:r((()=>[f(s,{class:"action-icon"},{default:r((()=>[f(B,{name:"service",size:44,color:"#FF6B00"})])),_:1}),f(s,{class:"action-content"},{default:r((()=>[f(l,{class:"action-title"},{default:r((()=>[m("联系客服")])),_:1}),f(l,{class:"action-desc"},{default:r((()=>[m("40077-20111")])),_:1})])),_:1}),f(B,{name:"arrow-right",size:32,color:"#ccc"})])),_:1}),f(s,{class:"action-item",onClick:aa},{default:r((()=>[f(s,{class:"action-icon"},{default:r((()=>[f(B,{name:"about",size:44,color:"#666"})])),_:1}),f(s,{class:"action-content"},{default:r((()=>[f(l,{class:"action-title"},{default:r((()=>[m("关于我们")])),_:1}),f(l,{class:"action-desc"},{default:r((()=>[m("了解更多关于EDP")])),_:1})])),_:1}),f(B,{name:"arrow-right",size:32,color:"#ccc"})])),_:1})])),_:1}),_(I).isLogin?(u(),n(s,{key:1,class:"logout-section"},{default:r((()=>[f(t,{class:"logout-btn",onClick:ea},{default:r((()=>[f(B,{name:"logout",size:36,color:"#C8161D"}),f(l,null,{default:r((()=>[m("退出登录")])),_:1})])),_:1})])),_:1})):v("",!0),f(s,{class:"page-footer"})])),_:1})}}},[["__scopeId","data-v-90f96ec5"]]);export{O as default};
