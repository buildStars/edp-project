import{T as e,U as a,D as l,d as t,c as s,w as u,h as d,F as i,j as o,e as c,A as n,k as m,z as f,i as v,r,G as _,H as g,a3 as h,x as p,I as b,t as V,ae as z,aj as y,y as I,ak as k,R as x}from"./index-Cljxm-NV.js";import{_ as U}from"./_plugin-vue_export-helper.BCo6x5W8.js";const w=U({__name:"rating-star",props:{modelValue:{type:Number,default:0},max:{type:Number,default:5},size:{type:String,default:"normal"},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:a}){const r=e,_=a,g=l((()=>Array.from({length:r.max})));return(a,l)=>{const h=f,p=v;return t(),s(p,{class:n(["rating-star",[`size-${e.size}`]])},{default:u((()=>[(t(!0),d(i,null,o(g.value,((a,l)=>(t(),s(p,{key:l,class:"star-item",onClick:e=>{return a=l+1,void(r.disabled||(_("update:modelValue",a),_("change",a)));var a}},{default:u((()=>[c(h,{class:n(["star-icon",{active:l<e.modelValue}])},{default:u((()=>[m("â˜…")])),_:2},1032,["class"])])),_:2},1032,["onClick"])))),128))])),_:1},8,["class"])}}},[["__scopeId","data-v-b856b4b2"]]),C=U({__name:"create",setup(o){const n=r(""),U=r(""),C=r(!1),j=r(""),M=r({title:"",coverImage:"",teacherName:""}),N=r({attitude1:0,attitude2:0,content1:0,content2:0,method1:0,method2:0,effect1:0,effect2:0,organization:0,suggestion:""}),A=r(!1),F=l((()=>N.value.attitude1>0||N.value.attitude2>0||N.value.content1>0||N.value.content2>0||N.value.method1>0||N.value.method2>0||N.value.effect1>0||N.value.effect2>0||N.value.organization>0));_((async e=>{n.value=e.courseId,U.value=e.chapterId||"",C.value="true"===e.viewMode||!0===e.viewMode,console.log("ğŸ“ è¯„ä»·é¡µé¢å‚æ•°:",{courseId:n.value,chapterId:U.value,viewMode:C.value}),await S(),C.value&&await T()}));const S=async()=>{try{g({title:"åŠ è½½ä¸­..."});const e=await h(n.value);M.value=e}catch(e){p({title:e.msg||"åŠ è½½å¤±è´¥",icon:"none"})}finally{b()}},T=async()=>{try{g({title:"åŠ è½½è¯„ä»·..."});const a=U.value&&""!==U.value.trim()?U.value:null,l=await function(a,l=null){const t=`/api/evaluations/course/${a}/my`;return l&&""!==l.trim()?e(t,{chapterId:l}):e(t)}(n.value,a);l&&(N.value={attitude1:l.attitude1||0,attitude2:l.attitude2||0,content1:l.content1||0,content2:l.content2||0,method1:l.method1||0,method2:l.method2||0,effect1:l.effect1||0,effect2:l.effect2||0,organization:l.organization||0,suggestion:l.suggestion||""},j.value=l.id)}catch(a){console.error("âŒ åŠ è½½è¯„ä»·å¤±è´¥:",a),p({title:a.msg||"åŠ è½½è¯„ä»·å¤±è´¥",icon:"none"})}finally{b()}},$=async()=>{if(F.value)try{A.value=!0;const e=[N.value.attitude1,N.value.attitude2,N.value.content1,N.value.content2,N.value.method1,N.value.method2,N.value.effect1,N.value.effect2,N.value.organization].filter((e=>e>0)),l=e.length>0?Math.round(e.reduce(((e,a)=>e+a),0)/e.length):0,t={courseId:n.value,rating:l,attitude1:N.value.attitude1,attitude2:N.value.attitude2,content1:N.value.content1,content2:N.value.content2,method1:N.value.method1,method2:N.value.method2,effect1:N.value.effect1,effect2:N.value.effect2,organization:N.value.organization,suggestion:N.value.suggestion};U.value&&(t.chapterId=U.value),console.log("ğŸ“ æäº¤è¯„ä»·æ•°æ®:",t),await function(e){return a("/api/evaluations",e)}(t),p({title:"è¯„ä»·æˆåŠŸ",icon:"success",duration:2e3}),setTimeout((()=>{z({success:()=>{y("evaluationSubmitted")}})}),2e3)}catch(e){p({title:e.msg||"è¯„ä»·å¤±è´¥",icon:"none"})}finally{A.value=!1}else p({title:"è¯·è‡³å°‘å®Œæˆä¸€é¡¹è¯„ä»·",icon:"none"})},B=()=>{z()};return(e,a)=>{const l=I,o=f,n=v,r=k,_=x;return t(),s(n,{class:"page"},{default:u((()=>[c(n,{class:"course-card"},{default:u((()=>[c(l,{src:M.value.coverImage,class:"cover",mode:"aspectFill"},null,8,["src"]),c(n,{class:"course-info"},{default:u((()=>[c(o,{class:"title"},{default:u((()=>[m(V(M.value.title),1)])),_:1}),c(o,{class:"teacher"},{default:u((()=>[m("è®²å¸ˆï¼š"+V(M.value.teacherName),1)])),_:1})])),_:1})])),_:1}),c(n,{class:"evaluation-form"},{default:u((()=>[c(n,{class:"form-title"},{default:u((()=>[m(V(C.value?"æˆ‘çš„è¯„ä»·":"è¯¾ç¨‹è¯„ä»·"),1)])),_:1}),c(n,{class:"form-section"},{default:u((()=>[c(n,{class:"section-title"},{default:u((()=>[m("æ•™å­¦æ€åº¦")])),_:1}),c(n,{class:"rating-item"},{default:u((()=>[c(n,{class:"item-desc"},{default:u((()=>[m("è€å¸ˆæ•™å­¦æŠ•å…¥ã€æœ‰æ¿€æƒ…")])),_:1}),c(w,{modelValue:N.value.attitude1,"onUpdate:modelValue":a[0]||(a[0]=e=>N.value.attitude1=e),disabled:C.value,size:"small"},null,8,["modelValue","disabled"])])),_:1}),c(n,{class:"rating-item"},{default:u((()=>[c(n,{class:"item-desc"},{default:u((()=>[m("è€å¸ˆæ•™å­¦è®¤çœŸã€è€å¿ƒã€è¯šæ³ã€å‹å¥½")])),_:1}),c(w,{modelValue:N.value.attitude2,"onUpdate:modelValue":a[1]||(a[1]=e=>N.value.attitude2=e),disabled:C.value,size:"small"},null,8,["modelValue","disabled"])])),_:1})])),_:1}),c(n,{class:"form-section"},{default:u((()=>[c(n,{class:"section-title"},{default:u((()=>[m("æ•™å­¦å†…å®¹")])),_:1}),c(n,{class:"rating-item"},{default:u((()=>[c(n,{class:"item-desc"},{default:u((()=>[m("è¯¾ç¨‹ä¸»é¢˜æ˜æ™°ï¼Œå†…å®¹æ¸…æ™°ï¼Œè®ºè¯ä¸¥å¯†")])),_:1}),c(w,{modelValue:N.value.content1,"onUpdate:modelValue":a[2]||(a[2]=e=>N.value.content1=e),disabled:C.value,size:"small"},null,8,["modelValue","disabled"])])),_:1}),c(n,{class:"rating-item"},{default:u((()=>[c(n,{class:"item-desc"},{default:u((()=>[m("è¯¾ç¨‹å†…å®¹å®è·µæ€§å¼ºï¼Œæ¡ˆä¾‹ä¸°å¯Œ")])),_:1}),c(w,{modelValue:N.value.content2,"onUpdate:modelValue":a[3]||(a[3]=e=>N.value.content2=e),disabled:C.value,size:"small"},null,8,["modelValue","disabled"])])),_:1})])),_:1}),c(n,{class:"form-section"},{default:u((()=>[c(n,{class:"section-title"},{default:u((()=>[m("æ•™å­¦æ–¹æ³•")])),_:1}),c(n,{class:"rating-item"},{default:u((()=>[c(n,{class:"item-desc"},{default:u((()=>[m("æ•™å­¦æ–¹æ³•å¾—å½“ï¼šé€»è¾‘æ€§å¼ºï¼Œæ¡ç†æ¸…æ™°ï¼Œé‡ç‚¹çªå‡º")])),_:1}),c(w,{modelValue:N.value.method1,"onUpdate:modelValue":a[4]||(a[4]=e=>N.value.method1=e),disabled:C.value,size:"small"},null,8,["modelValue","disabled"])])),_:1}),c(n,{class:"rating-item"},{default:u((()=>[c(n,{class:"item-desc"},{default:u((()=>[m("æ•™å­¦å¯¹é—®é¢˜çš„é˜ææ€§å¼º")])),_:1}),c(w,{modelValue:N.value.method2,"onUpdate:modelValue":a[5]||(a[5]=e=>N.value.method2=e),disabled:C.value,size:"small"},null,8,["modelValue","disabled"])])),_:1})])),_:1}),c(n,{class:"form-section"},{default:u((()=>[c(n,{class:"section-title"},{default:u((()=>[m("æ•™å­¦æ•ˆæœ")])),_:1}),c(n,{class:"rating-item"},{default:u((()=>[c(n,{class:"item-desc"},{default:u((()=>[m("è¾¾åˆ°é¢„æœŸè¦æ±‚ï¼Œå­¦ä¹ æœ‰æ•ˆï¼Œå¯¹å·¥ä½œæˆ–æˆé•¿æä¾›å¸®åŠ©")])),_:1}),c(w,{modelValue:N.value.effect1,"onUpdate:modelValue":a[6]||(a[6]=e=>N.value.effect1=e),disabled:C.value,size:"small"},null,8,["modelValue","disabled"])])),_:1}),c(n,{class:"rating-item"},{default:u((()=>[c(n,{class:"item-desc"},{default:u((()=>[m("å­¦ä¹ äº†æŒæ¡æ–°æ€æƒ³æˆ–æ–°æŠ€èƒ½")])),_:1}),c(w,{modelValue:N.value.effect2,"onUpdate:modelValue":a[7]||(a[7]=e=>N.value.effect2=e),disabled:C.value,size:"small"},null,8,["modelValue","disabled"])])),_:1})])),_:1}),c(n,{class:"form-section"},{default:u((()=>[c(n,{class:"section-title"},{default:u((()=>[m("æ•™åŠ¡ç»„ç»‡")])),_:1}),c(n,{class:"rating-item"},{default:u((()=>[c(n,{class:"item-desc"},{default:u((()=>[m("æ•™å­¦è¯¾ç¨‹èµ„æ–™å‡†å¤‡å……åˆ†")])),_:1}),c(w,{modelValue:N.value.organization,"onUpdate:modelValue":a[8]||(a[8]=e=>N.value.organization=e),disabled:C.value,size:"small"},null,8,["modelValue","disabled"])])),_:1})])),_:1}),c(n,{class:"form-section"},{default:u((()=>[c(n,{class:"section-title"},{default:u((()=>[m("æ‚¨å¯¹æœ¬æ¬¡è¯¾ç¨‹çš„å»ºè®®")])),_:1}),c(r,{modelValue:N.value.suggestion,"onUpdate:modelValue":a[9]||(a[9]=e=>N.value.suggestion=e),disabled:C.value,class:"suggestion-input",placeholder:"è¯·è¾“å…¥æ‚¨çš„å»ºè®®å’Œæ„è§ï¼ˆé€‰å¡«ï¼‰",maxlength:"500","show-confirm-bar":!1},null,8,["modelValue","disabled"]),c(n,{class:"char-count"},{default:u((()=>[m(V(N.value.suggestion.length)+"/500",1)])),_:1})])),_:1})])),_:1}),c(n,{class:"tip-section"},{default:u((()=>[c(n,{class:"tip-title"},{default:u((()=>[m("æ¸©é¦¨æç¤º")])),_:1}),c(n,{class:"tip-item"},{default:u((()=>[c(o,{class:"icon"},{default:u((()=>[m("â­")])),_:1}),c(o,{class:"text"},{default:u((()=>[m("æ¯é¡¹è¯„ä»·æ»¡åˆ†10åˆ†ï¼Œæ‚¨çš„è¯„ä»·å°†å¸®åŠ©æˆ‘ä»¬æ”¹è¿›è¯¾ç¨‹è´¨é‡")])),_:1})])),_:1}),c(n,{class:"tip-item highlight"},{default:u((()=>[c(o,{class:"icon"},{default:u((()=>[m("ğŸ”’")])),_:1}),c(o,{class:"text"},{default:u((()=>[m("æ‚¨çš„è¯„ä»·ä¸ºåŒ¿åè¯„ä»·ï¼Œæˆè¯¾è€å¸ˆæ— æ³•æŸ¥çœ‹å…·ä½“è¯„ä»·å†…å®¹")])),_:1})])),_:1}),c(n,{class:"tip-item highlight"},{default:u((()=>[c(o,{class:"icon"},{default:u((()=>[m("ğŸ‘¥")])),_:1}),c(o,{class:"text"},{default:u((()=>[m("ç®¡ç†å‘˜/æ•™åŠ¡äººå‘˜ä¼šå¯¹è€å¸ˆè¿›è¡Œåé¦ˆï¼Œå¸®åŠ©æ”¹è¿›æ•™å­¦è´¨é‡")])),_:1})])),_:1}),c(n,{class:"tip-item"},{default:u((()=>[c(o,{class:"icon"},{default:u((()=>[m("ğŸ“„")])),_:1}),c(o,{class:"text"},{default:u((()=>[m("è¯„ä»·å®Œæˆåå³å¯ä¸‹è½½è¯¾ä»¶èµ„æ–™")])),_:1})])),_:1})])),_:1}),c(n,{class:"footer"},{default:u((()=>[C.value?(t(),s(_,{key:0,class:"btn-back",onClick:B},{default:u((()=>[m("è¿”å›")])),_:1})):(t(),d(i,{key:1},[c(_,{class:"btn-cancel",onClick:B},{default:u((()=>[m("å–æ¶ˆ")])),_:1}),c(_,{class:"btn-submit",onClick:$,loading:A.value,disabled:!F.value},{default:u((()=>[m(" æäº¤è¯„ä»· ")])),_:1},8,["loading","disabled"])],64))])),_:1})])),_:1})}}},[["__scopeId","data-v-10e50307"]]);export{C as default};
