import{J as e,m as t,C as a,D as l,M as s,N as o,O as c,P as n,Q as i,d as r,c as u,w as d,e as f,R as h,k as m,t as v,n as _,f as g,q as p,i as C,p as S,T as y,U as k,r as b,u as D,B as T,$ as w,V as I,W as x,X as E,Y as F,z as P,Z as z,H as N,v as $,h as A,j as M,F as L,_ as O,l as R,a0 as G,a1 as j,I as V,a2 as H}from"./index-CCW0MaS3.js";import{g as J,c as U}from"./checkin.FGmzj8oD.js";import{g as q}from"./course-gift.BHW34qfO.js";import{g as B}from"./chapter.CPjARXA3.js";import{f as W}from"./util.BUrGU9NL.js";import{I as Y}from"./icon.Br2I0aeN.js";import{_ as Q}from"./_plugin-vue_export-helper.BCo6x5W8.js";function X(t){return e(`/api/enrollments/completion-poster/${t}`)}const Z=Q({name:"CompletionPoster",props:{visible:{type:Boolean,default:!1},posterData:{type:Object,default:()=>({userName:"",courseName:"",teacherName:"",completionDate:"",courseCredit:0,achievementCredit:0,checkinCount:0,coverImage:""})}},data:()=>({canvasHeight:900,isGenerating:!1}),computed:{completionDateText(){if(!this.posterData.completionDate)return"--";const e=new Date(this.posterData.completionDate);return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}},methods:{handleClose(){this.$emit("close")},handleConfirm(){this.$emit("confirm")},handleShare(){this.$emit("share")},handleOverlayTap(){},async handleSavePoster(){if(this.isGenerating)t({title:"æµ·æŠ¥ç”Ÿæˆä¸­ï¼Œè¯·ç¨å€™",icon:"none"});else try{this.isGenerating=!0,a({title:"ç”Ÿæˆæµ·æŠ¥ä¸­...",mask:!0});const e=await this.generatePosterImage();l(),s({filePath:e,success:()=>{t({title:"æµ·æŠ¥å·²ä¿å­˜åˆ°ç›¸å†Œ",icon:"success",duration:2e3}),setTimeout((()=>{o({title:"åˆ†äº«åˆ°æœ‹å‹åœˆ",content:"æµ·æŠ¥å·²ä¿å­˜åˆ°ç›¸å†Œï¼Œå¯ä»¥åœ¨æœ‹å‹åœˆå‘é€å›¾ç‰‡æ—¶é€‰æ‹©æ­¤æµ·æŠ¥åˆ†äº«",showCancel:!1,confirmText:"çŸ¥é“äº†"})}),2e3),this.isGenerating=!1},fail:e=>{this.isGenerating=!1,e.errMsg.includes("auth")?o({title:"éœ€è¦ç›¸å†Œæƒé™",content:"ä¿å­˜å›¾ç‰‡éœ€è¦ç›¸å†Œæƒé™ï¼Œè¯·åœ¨è®¾ç½®ä¸­å¼€å¯",confirmText:"å»è®¾ç½®",cancelText:"å–æ¶ˆ",success:e=>{e.confirm&&uni.openSetting()}}):t({title:"ä¿å­˜å¤±è´¥ï¼Œè¯·é‡è¯•",icon:"none"})}})}catch(e){console.error("ç”Ÿæˆæµ·æŠ¥å¤±è´¥:",e),l(),this.isGenerating=!1,t({title:e.message||"ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•",icon:"none",duration:2e3})}},generatePosterImage(){return new Promise(((e,t)=>{const a=c("posterCanvas",this),l=660,s=900,o=a.createLinearGradient(0,0,l,s);o.addColorStop(0,"#667eea"),o.addColorStop(1,"#764ba2"),a.setFillStyle(o),a.fillRect(0,0,l,s),this.drawRoundRect(a,30,30,600,840,20,"#ffffff");let i=80;a.setFontSize(50),a.setFillStyle("#667eea"),a.setTextAlign("center"),a.fillText("ğŸ“",330,i),i+=60,a.setFontSize(32),a.setFillStyle("#333333"),a.fillText("æ­å–œå®Œæˆè¯¾ç¨‹",330,i),i+=80,a.setFontSize(38),a.setFillStyle("#667eea"),a.fillText(this.posterData.userName,330,i),i+=50,a.setFontSize(24),a.setFillStyle("#999999"),a.fillText("åœ¨æœ¬æ¬¡å­¦ä¹ ä¸­è¡¨ç°ä¼˜å¼‚",330,i),i+=60;const r=i,u=180;this.drawRoundRect(a,60,r,540,u,15,"#f8f9fa"),this.posterData.coverImage?n({url:this.posterData.coverImage,success:o=>{200===o.statusCode?(a.drawImage(o.tempFilePath,80,r+20,140,140),this.drawCourseInfo(a,l,s,i+u,e,t)):this.drawCourseInfo(a,l,s,i+u,e,t)},fail:()=>{this.drawCourseInfo(a,l,s,i+u,e,t)}}):this.drawCourseInfo(a,l,s,i+u,e,t),a.setTextAlign("left"),a.setFontSize(26),a.setFillStyle("#333333");const d=240;a.fillText(this.posterData.courseName.substring(0,12),d,r+50),this.posterData.courseName.length>12&&a.fillText(this.posterData.courseName.substring(12,24),d,r+80),a.setFontSize(20),a.setFillStyle("#666666"),a.fillText(`ğŸ‘¨â€ğŸ« ${this.posterData.teacherName}`,d,r+110),a.fillText(`ğŸ“… ${this.completionDateText}`,d,r+140)}))},drawCourseInfo(e,t,a,l,s,o){const c=l+=60,n=(t-120)/3;e.setTextAlign("center"),e.setFontSize(48),e.setFillStyle("#667eea"),e.fillText(this.posterData.achievementCredit.toString(),60+n/2,c),e.setFontSize(22),e.setFillStyle("#999999"),e.fillText("è·å¾—å­¦åˆ†",60+n/2,c+50),e.setFontSize(48),e.setFillStyle("#667eea"),e.fillText(this.posterData.checkinCount.toString(),60+1.5*n,c),e.setFontSize(22),e.setFillStyle("#999999"),e.fillText("ç­¾åˆ°æ¬¡æ•°",60+1.5*n,c+50),e.setFontSize(48),e.setFillStyle("#667eea"),e.fillText(this.posterData.courseCredit.toString(),60+2.5*n,c),e.setFontSize(22),e.setFillStyle("#999999"),e.fillText("è¯¾ç¨‹å­¦åˆ†",60+2.5*n,c+50),l+=150,e.setFontSize(24),e.setFillStyle("#999999"),e.fillText("ç»§ç»­ä¿æŒï¼Œå†æ¥å†å‰ï¼",t/2,l),e.draw(!1,(()=>{setTimeout((()=>{i({canvasId:"posterCanvas",success:e=>{s(e.tempFilePath)},fail:e=>{o(new Error("ç”Ÿæˆå›¾ç‰‡å¤±è´¥"))}},this)}),500)}))},drawRoundRect(e,t,a,l,s,o,c){e.beginPath(),e.arc(t+o,a+o,o,Math.PI,1.5*Math.PI),e.arc(t+l-o,a+o,o,1.5*Math.PI,2*Math.PI),e.arc(t+l-o,a+s-o,o,0,.5*Math.PI),e.arc(t+o,a+s-o,o,.5*Math.PI,Math.PI),e.closePath(),e.setFillStyle(c),e.fill()}}},[["render",function(e,t,a,l,s,o){const c=p,n=C,i=S,b=y,D=k;return a.visible?(r(),u(n,{key:0,class:"poster-overlay",onClick:o.handleOverlayTap},{default:d((()=>[f(n,{class:"poster-container",onClick:t[0]||(t[0]=h((()=>{}),["stop"]))},{default:d((()=>[f(n,{class:"close-btn",onClick:o.handleClose},{default:d((()=>[f(c,{class:"icon"},{default:d((()=>[m("âœ•")])),_:1})])),_:1},8,["onClick"]),f(n,{class:"poster-content"},{default:d((()=>[f(n,{class:"poster-header"},{default:d((()=>[f(c,{class:"header-icon"},{default:d((()=>[m("ğŸ“")])),_:1}),f(c,{class:"header-text"},{default:d((()=>[m("æ­å–œå®Œæˆè¯¾ç¨‹")])),_:1})])),_:1}),f(n,{class:"user-section"},{default:d((()=>[f(c,{class:"user-name"},{default:d((()=>[m(v(a.posterData.userName),1)])),_:1}),f(c,{class:"congratulations"},{default:d((()=>[m("åœ¨æœ¬æ¬¡å­¦ä¹ ä¸­è¡¨ç°ä¼˜å¼‚")])),_:1})])),_:1}),f(n,{class:"course-card"},{default:d((()=>[f(n,{class:"course-cover-wrapper"},{default:d((()=>[f(i,{class:"course-cover",src:a.posterData.coverImage||"/static/images/default-course.png",mode:"aspectFill"},null,8,["src"])])),_:1}),f(n,{class:"course-details"},{default:d((()=>[f(c,{class:"course-title"},{default:d((()=>[m(v(a.posterData.courseName),1)])),_:1}),f(n,{class:"course-meta"},{default:d((()=>[f(c,{class:"meta-item"},{default:d((()=>[m("ğŸ‘¨â€ğŸ« "+v(a.posterData.teacherName),1)])),_:1}),f(c,{class:"meta-item"},{default:d((()=>[m("ğŸ“… "+v(o.completionDateText),1)])),_:1})])),_:1})])),_:1})])),_:1}),f(n,{class:"achievement-grid"},{default:d((()=>[f(n,{class:"achievement-item"},{default:d((()=>[f(c,{class:"achievement-value"},{default:d((()=>[m(v(a.posterData.achievementCredit),1)])),_:1}),f(c,{class:"achievement-label"},{default:d((()=>[m("è·å¾—å­¦åˆ†")])),_:1})])),_:1}),f(n,{class:"achievement-item"},{default:d((()=>[f(c,{class:"achievement-value"},{default:d((()=>[m(v(a.posterData.checkinCount),1)])),_:1}),f(c,{class:"achievement-label"},{default:d((()=>[m("ç­¾åˆ°æ¬¡æ•°")])),_:1})])),_:1}),f(n,{class:"achievement-item"},{default:d((()=>[f(c,{class:"achievement-value"},{default:d((()=>[m(v(a.posterData.courseCredit),1)])),_:1}),f(c,{class:"achievement-label"},{default:d((()=>[m("è¯¾ç¨‹å­¦åˆ†")])),_:1})])),_:1})])),_:1}),f(n,{class:"poster-actions"},{default:d((()=>[f(b,{class:"btn-share",onClick:o.handleShare,"open-type":"share"},{default:d((()=>[f(c,{class:"btn-text"},{default:d((()=>[m("åˆ†äº«å¥½å‹")])),_:1})])),_:1},8,["onClick"]),f(b,{class:"btn-save",onClick:o.handleSavePoster},{default:d((()=>[f(c,{class:"btn-text"},{default:d((()=>[m("ä¿å­˜æµ·æŠ¥")])),_:1})])),_:1},8,["onClick"]),f(b,{class:"btn-confirm",onClick:o.handleConfirm},{default:d((()=>[f(c,{class:"btn-text"},{default:d((()=>[m("ç¡®è®¤")])),_:1})])),_:1},8,["onClick"])])),_:1}),f(n,{class:"poster-footer"},{default:d((()=>[f(c,{class:"footer-text"},{default:d((()=>[m("ç»§ç»­ä¿æŒï¼Œå†æ¥å†å‰ï¼")])),_:1})])),_:1})])),_:1})])),_:1}),a.visible?(r(),u(D,{key:0,"canvas-id":"posterCanvas",style:_({width:"660px",height:s.canvasHeight+"px",position:"fixed",left:"-9999px",top:"-9999px"})},null,8,["style"])):g("",!0)])),_:1},8,["onClick"])):g("",!0)}],["__scopeId","data-v-5bab05e2"]]),K=Q({__name:"detail",setup(e){const s=b({title:"",coverImage:"",credit:0,teacherName:"",teacherAvatar:"",teacherTitle:"",teacherIntro:"",startTime:"",location:"",enrollStatus:"CLOSED",introduction:"",isEnrolled:!1,hasEvaluated:!1}),c=b(""),n=b(""),i=b(!1),_=b([]),k=D(),Q=b(!1),K=b({hasActiveSession:!1,canCheckin:!1,alreadyCheckedIn:!1,remainingMinutes:0}),ee=b(""),te=b(!1),ae=b({userName:"",courseName:"",teacherName:"",completionDate:new Date,courseCredit:0,achievementCredit:0,checkinCount:0,coverImage:"",isFirstTime:!1});T((async e=>{e.id&&(c.value=e.id,await le(),await ve(),"checkin"===e.action&&setTimeout((()=>{s.value.isEnrolled&&K.value.hasActiveSession&&K.value.canCheckin?ce():t({title:"å½“å‰æ²¡æœ‰è¿›è¡Œä¸­çš„ç­¾åˆ°",icon:"none"})}),500))})),w("evaluationSubmitted",(async()=>{await le()})),I((()=>{x("evaluationSubmitted")}));const le=async()=>{a({title:"åŠ è½½ä¸­..."});try{const e=await E(c.value);console.log("ğŸ“š è¯¾ç¨‹è¯¦æƒ…æ•°æ®:",e),console.log("ğŸ“Œ isEnrolled å­—æ®µ:",e.isEnrolled),s.value=e,se(),console.log("ğŸ” æ£€æŸ¥æ˜¯å¦éœ€è¦åŠ è½½ç­¾åˆ°ä¼šè¯:"),console.log("   - data.isEnrolled:",e.isEnrolled),console.log("   - userStore.isLogin:",k.isLogin),e.isEnrolled&&k.isLogin?(console.log("âœ… æ¡ä»¶æ»¡è¶³ï¼Œå¼€å§‹åŠ è½½ç­¾åˆ°ä¼šè¯"),await oe()):console.log("âŒ æ¡ä»¶ä¸æ»¡è¶³ï¼Œè·³è¿‡åŠ è½½ç­¾åˆ°ä¼šè¯")}catch(e){console.error("åŠ è½½è¯¾ç¨‹è¯¦æƒ…å¤±è´¥ï¼š",e),t({title:"åŠ è½½å¤±è´¥",icon:"none"})}finally{l()}},se=async()=>{try{console.log("ğŸ“– å¼€å§‹åŠ è½½ç« èŠ‚åˆ—è¡¨ï¼ŒcourseId:",c.value),console.log("ğŸ‘¤ å½“å‰ç”¨æˆ·ç™»å½•çŠ¶æ€:",k.isLogin),console.log("ğŸ”‘ å½“å‰ token:",F("token")?"å·²æœ‰token":"æ— token");const e=await B({courseId:c.value,status:"PUBLISHED"});console.log("ğŸ“š ç« èŠ‚åˆ—è¡¨è¿”å›æ•°æ®:",JSON.stringify(e,null,2)),e.items&&e.items.length>0&&e.items.forEach(((e,t)=>{console.log(`ç« èŠ‚ ${t+1}: ${e.title}`),console.log(`  - hasCheckedIn: ${e.hasCheckedIn}`),console.log(`  - hasEvaluated: ${e.hasEvaluated}`)})),_.value=e.items||[],console.log("âœ… ç« èŠ‚åˆ—è¡¨æ›´æ–°å®Œæˆï¼Œå…±",_.value.length,"ä¸ªç« èŠ‚")}catch(e){console.error("âŒ åŠ è½½ç« èŠ‚åˆ—è¡¨å¤±è´¥:",e)}},oe=async()=>{try{const e=await J(c.value);console.log("ğŸ”” è·å–ç­¾åˆ°ä¼šè¯è¿”å›:",JSON.stringify(e,null,2)),K.value=e,console.log("ğŸ”” æ›´æ–°åçš„ checkinSession.value:",JSON.stringify(K.value,null,2)),console.log("ğŸ”” ç­¾åˆ°æŒ‰é’®æ˜¾ç¤ºæ¡ä»¶:"),console.log("   - courseDetail.refundStatus:",s.value.refundStatus),console.log("   - checkinSession.hasActiveSession:",K.value.hasActiveSession),console.log("   - checkinSession.alreadyCheckedIn:",K.value.alreadyCheckedIn),console.log("   - åº”è¯¥æ˜¾ç¤ºç­¾åˆ°æŒ‰é’®:",!s.value.refundStatus&&K.value.hasActiveSession&&!K.value.alreadyCheckedIn),e.hasActiveSession&&e.canCheckin&&setTimeout(oe,6e4)}catch(e){console.error("è·å–ç­¾åˆ°ä¼šè¯å¤±è´¥ï¼š",e)}},ce=()=>{ee.value="",Q.value=!0},ne=()=>{Q.value=!1,ee.value=""},ie=async()=>{if(ee.value&&6===ee.value.length)try{a({title:"ç­¾åˆ°ä¸­..."}),console.log("ğŸ“¤ å‘èµ·ç­¾åˆ°è¯·æ±‚:",{courseId:c.value,code:ee.value});const e=await U({courseId:c.value,code:ee.value});console.log("âœ… ç­¾åˆ°æˆåŠŸï¼Œè¿”å›æ•°æ®:",e),l(),ne(),K.value.alreadyCheckedIn=!0,K.value.canCheckin=!1;const t="ON_TIME"===e.status;o({title:"ç­¾åˆ°æˆåŠŸ",content:`${t?"å‡†æ—¶ç­¾åˆ°":"è¿Ÿåˆ°ç­¾åˆ°"}ï¼${e.message||""}`,showCancel:!1,confirmText:"ç¡®å®š",confirmColor:"#52C41A",success:async()=>{await le(),await se()}}),O({type:"medium"})}catch(e){console.error("âŒ ç­¾åˆ°å¤±è´¥:",e),l();const t=e.msg||e.message||"ç­¾åˆ°å¤±è´¥ï¼Œè¯·é‡è¯•";o({title:"ç­¾åˆ°å¤±è´¥",content:t,showCancel:!1,confirmText:"æˆ‘çŸ¥é“äº†",confirmColor:"#C8161D"}),O({type:"heavy"}),ee.value=""}else t({title:"è¯·è¾“å…¥6ä½ç­¾åˆ°ç ",icon:"none"})},re=async()=>{if(!k.checkLogin())return;try{await k.fetchCredits()}catch(t){console.error("è·å–å­¦åˆ†å¤±è´¥ï¼š",t)}const e=s.value.credit||0;(k.remainingCredits||0)<e?ue():de()},ue=()=>{const e=s.value.credit||0,t=k.remainingCredits||0;o({title:"å­¦åˆ†ä¸è¶³",content:`æœ¬è¯¾ç¨‹éœ€è¦ ${e} å­¦åˆ†ï¼Œæ‚¨å½“å‰å‰©ä½™ ${t} å­¦åˆ†ã€‚\n\næ‚¨å¯ä»¥ç”³è¯·è¯•å¬è¯¾ç¨‹ï¼Œè¯¾ç¨‹é¡¾é—®å°†ä¸æ‚¨è”ç³»å®‰æ’è¯•å¬ã€‚`,confirmText:"ç”³è¯·è¯•å¬",cancelText:"å–æ¶ˆ",success:e=>{e.confirm&&R({url:`/pages/enrollment-request/create?courseId=${c.value}`})}})},de=()=>{const e=s.value.credit||0,n=k.remainingCredits||0;o({title:"ç¡®è®¤æŠ¥å",content:`æœ¬æ¬¡è¯¾ç¨‹éœ€è¦æ¶ˆè€— ${e} å­¦åˆ†\nå½“å‰å‰©ä½™å­¦åˆ†ï¼š${n}\næŠ¥ååå‰©ä½™ï¼š${n-e}\n\nç¡®è®¤æŠ¥åå—ï¼Ÿ`,success:async e=>{if(e.confirm)try{a({title:"æŠ¥åä¸­..."});const e=await G(c.value);if(l(),!e.success&&e.needCredit)return void ue();e.success&&(t({title:e.message||"æŠ¥åæˆåŠŸ",icon:"success"}),await Promise.all([k.fetchCredits(),le()]))}catch(s){l(),console.error("æŠ¥åå¤±è´¥ï¼š",s),t({title:s.msg||"æŠ¥åå¤±è´¥",icon:"none"})}}})},fe=P((()=>{if(!s.value.isEnrolled)return!1;if(s.value.isGift)return!1;const e=new Date,t=new Date(s.value.startTime);return Math.ceil((t-e)/864e5)>3})),he=()=>{const e=new Date,a=new Date(s.value.startTime),l=Math.ceil((a-e)/864e5);l<=3?t({title:`å¼€è¯¾å‰3å¤©å†…ä¸èƒ½é€€è¯¾ï¼Œå½“å‰è·ç¦»å¼€è¯¾è¿˜æœ‰${l}å¤©`,icon:"none",duration:3e3}):o({title:"ç¡®è®¤é€€è¯¾",content:`é€€è¯¾åå°†é€€å› ${s.value.credit} å­¦åˆ†ï¼Œç¡®è®¤é€€è¯¾å—ï¼Ÿ`,success:async e=>{e.confirm&&R({url:`/pages/refund-request/create?courseId=${c.value}`})}})},me=async()=>{try{a({title:"ç”Ÿæˆä¸­..."});const e=await q({courseId:c.value,message:`æ¨èæ‚¨å­¦ä¹ ã€Š${s.value.title}ã€‹`});l(),e.giftCode&&(n.value=e.giftCode,o({title:"è¯¾ç¨‹èµ é€",content:`ç¤¼ç‰©ç ï¼š${e.giftCode}\n\nè¯·å°†ç¤¼ç‰©ç åˆ†äº«ç»™å¥½å‹ï¼Œå¥½å‹å¯åœ¨å°ç¨‹åºä¸­è¾“å…¥ç¤¼ç‰©ç é¢†å–è¯¾ç¨‹ã€‚\n\nç‚¹å‡»ç¡®å®šå¤åˆ¶ç¤¼ç‰©ç ã€‚`,confirmText:"å¤åˆ¶ç¤¼ç‰©ç ",success:a=>{a.confirm&&j({data:e.giftCode,success:()=>{t({title:"ç¤¼ç‰©ç å·²å¤åˆ¶",icon:"success"})}})}}))}catch(e){l(),t({title:e.msg||"ç”Ÿæˆå¤±è´¥",icon:"none"})}},ve=async()=>{if(console.log("ğŸ¨ checkAndShowCompletionPoster å¼€å§‹"),console.log("   - isLogin:",k.isLogin),console.log("   - isEnrolled:",s.value.isEnrolled),console.log("   - enrollmentStatus:",s.value.enrollmentStatus),k.isLogin&&s.value.isEnrolled)if("COMPLETED"===s.value.enrollmentStatus)try{console.log("ğŸ“¡ å¼€å§‹è·å–ç»“è¯¾æµ·æŠ¥...");const e=await X(c.value);console.log("âœ… è·å–æµ·æŠ¥æˆåŠŸ:",e),e.isFirstTime?(console.log("ğŸ‰ é¦–æ¬¡æŸ¥çœ‹ï¼Œå¼¹å‡ºæµ·æŠ¥ï¼"),ae.value=e,te.value=!0,console.log("ğŸ“Š posterData:",ae.value),console.log("ğŸ“Š showCompletionPoster:",te.value),z((()=>{console.log("ğŸ”„ nextTick - showCompletionPoster:",te.value)}))):console.log("â„¹ï¸ éé¦–æ¬¡æŸ¥çœ‹ï¼Œä¸è‡ªåŠ¨å¼¹å‡º")}catch(e){console.log("âŒ è·å–ç»“è¯¾æµ·æŠ¥å¤±è´¥ï¼š",e.msg||e.message)}else console.log("âŒ è¯¾ç¨‹æœªå®Œæˆï¼Œè·³è¿‡æµ·æŠ¥æ£€æŸ¥");else console.log("âŒ æœªç™»å½•æˆ–æœªæŠ¥åï¼Œè·³è¿‡æµ·æŠ¥æ£€æŸ¥")},_e=async()=>{try{a({title:"åŠ è½½ä¸­..."});const e=await X(c.value);ae.value=e,te.value=!0,l()}catch(e){l(),t({title:e.msg||"åŠ è½½å¤±è´¥",icon:"none"})}},ge=()=>{te.value=!1},pe=()=>{te.value=!1,i.value=!1},Ce=()=>{i.value=!0,te.value=!1,setTimeout((()=>{i.value=!1}),3e3)};return(e,t)=>{const a=S,l=C,o=p,c=V,n=y,i=H;return r(),u(l,{class:"page"},{default:d((()=>[f(l,{class:"course-header"},{default:d((()=>[f(a,{src:s.value.coverImage,class:"course-cover",mode:"aspectFill"},null,8,["src"]),f(l,{class:"header-overlay"},{default:d((()=>[f(l,{class:"header-gradient"}),f(l,{class:"header-badges"},{default:d((()=>[f(l,{class:"credit-badge"},{default:d((()=>[f(Y,{name:"star",size:32,color:"#fff"}),f(o,{class:"badge-text"},{default:d((()=>[m(v(s.value.credit)+"å­¦åˆ†",1)])),_:1})])),_:1}),s.value.category?(r(),u(l,{key:0,class:"category-badge"},{default:d((()=>[f(o,null,{default:d((()=>{return[m(v((e=s.value.category,{ACCELERATE:"åŠ é€Ÿè¯¾å ‚",MASTER:"å¤§å¸ˆè¯¾å ‚",EMPOWER:"èµ‹èƒ½è¯¾å ‚"}[e]||e)),1)];var e})),_:1})])),_:1})):g("",!0)])),_:1})])),_:1})])),_:1}),f(l,{class:"course-info-section"},{default:d((()=>[f(l,{class:"course-title"},{default:d((()=>[m(v(s.value.title),1)])),_:1}),f(l,{class:"info-grid"},{default:d((()=>[f(l,{class:"info-card"},{default:d((()=>[f(l,{class:"info-icon-wrapper teacher-icon"},{default:d((()=>[f(Y,{name:"user",size:44,color:"#C8161D"})])),_:1}),f(l,{class:"info-content"},{default:d((()=>[f(l,{class:"info-label"},{default:d((()=>[m("æˆè¯¾è€å¸ˆ")])),_:1}),f(l,{class:"info-value"},{default:d((()=>[m(v(s.value.teacherName),1)])),_:1})])),_:1})])),_:1}),f(l,{class:"info-card"},{default:d((()=>[f(l,{class:"info-icon-wrapper time-icon"},{default:d((()=>[f(Y,{name:"time",size:44,color:"#667eea"})])),_:1}),f(l,{class:"info-content"},{default:d((()=>[f(l,{class:"info-label"},{default:d((()=>[m("ä¸Šè¯¾æ—¶é—´")])),_:1}),f(l,{class:"info-value"},{default:d((()=>[m(v(N(W)(s.value.startTime)),1)])),_:1})])),_:1})])),_:1}),f(l,{class:"info-card"},{default:d((()=>[f(l,{class:"info-icon-wrapper location-icon"},{default:d((()=>[f(Y,{name:"location",size:44,color:"#f5576c"})])),_:1}),f(l,{class:"info-content"},{default:d((()=>[f(l,{class:"info-label"},{default:d((()=>[m("ä¸Šè¯¾åœ°ç‚¹")])),_:1}),f(l,{class:"info-value"},{default:d((()=>[m(v(s.value.location),1)])),_:1})])),_:1})])),_:1}),f(l,{class:"info-card"},{default:d((()=>[f(l,{class:"info-icon-wrapper status-icon"},{default:d((()=>[f(Y,{name:"OPEN"===s.value.enrollStatus?"check":"close",size:44,color:"OPEN"===s.value.enrollStatus?"#52C41A":"#999"},null,8,["name","color"])])),_:1}),f(l,{class:"info-content"},{default:d((()=>[f(l,{class:"info-label"},{default:d((()=>[m("æŠ¥åçŠ¶æ€")])),_:1}),f(l,{class:$(["info-value",{"status-closed":"CLOSED"===s.value.enrollStatus}])},{default:d((()=>[m(v("OPEN"===s.value.enrollStatus?"æŠ¥åä¸­":"å·²æˆªæ­¢"),1)])),_:1},8,["class"])])),_:1})])),_:1})])),_:1})])),_:1}),f(l,{class:"section introduction-section"},{default:d((()=>[f(l,{class:"section-header"},{default:d((()=>[f(l,{class:"section-icon"},{default:d((()=>[f(Y,{name:"course",size:40,color:"#C8161D"})])),_:1}),f(l,{class:"section-title-wrapper"},{default:d((()=>[f(o,{class:"section-title"},{default:d((()=>[m("è¯¾ç¨‹ä»‹ç»")])),_:1}),f(o,{class:"section-subtitle"},{default:d((()=>[m("Course Introduction")])),_:1})])),_:1})])),_:1}),f(l,{class:"section-content"},{default:d((()=>[f(c,{nodes:s.value.introduction},null,8,["nodes"])])),_:1})])),_:1}),f(l,{class:"section teacher-section"},{default:d((()=>[f(l,{class:"section-header"},{default:d((()=>[f(l,{class:"section-icon"},{default:d((()=>[f(Y,{name:"user",size:40,color:"#C8161D"})])),_:1}),f(l,{class:"section-title-wrapper"},{default:d((()=>[f(o,{class:"section-title"},{default:d((()=>[m("è®²å¸ˆä»‹ç»")])),_:1}),f(o,{class:"section-subtitle"},{default:d((()=>[m("Teacher Introduction")])),_:1})])),_:1})])),_:1}),f(l,{class:"teacher-card"},{default:d((()=>[f(l,{class:"teacher-avatar-wrapper"},{default:d((()=>[f(a,{src:s.value.teacherAvatar,class:"teacher-avatar"},null,8,["src"]),f(l,{class:"avatar-decoration"})])),_:1}),f(l,{class:"teacher-info"},{default:d((()=>[f(l,{class:"teacher-name"},{default:d((()=>[m(v(s.value.teacherName),1)])),_:1}),f(l,{class:"teacher-title"},{default:d((()=>[m(v(s.value.teacherTitle),1)])),_:1})])),_:1})])),_:1}),f(l,{class:"section-content"},{default:d((()=>[f(c,{nodes:s.value.teacherIntro},null,8,["nodes"])])),_:1})])),_:1}),f(l,{class:"section chapters-section"},{default:d((()=>[f(l,{class:"section-header"},{default:d((()=>[f(l,{class:"section-icon"},{default:d((()=>[f(Y,{name:"course",size:40,color:"#C8161D"})])),_:1}),f(l,{class:"section-title-wrapper"},{default:d((()=>[f(o,{class:"section-title"},{default:d((()=>[m("ç« èŠ‚ä»‹ç»")])),_:1}),f(o,{class:"section-subtitle"},{default:d((()=>[m("Chapters")])),_:1})])),_:1})])),_:1}),_.value.length>0?(r(),u(l,{key:0,class:"chapters-list"},{default:d((()=>[(r(!0),A(L,null,M(_.value,((e,t)=>(r(),u(l,{key:e.id,class:"chapter-item"},{default:d((()=>[f(l,{class:"chapter-number"},{default:d((()=>[m(v(t+1),1)])),_:2},1024),f(l,{class:"chapter-title"},{default:d((()=>[m(v(e.title),1)])),_:2},1024)])),_:2},1024)))),128))])),_:1})):(r(),u(l,{key:1,class:"empty-chapters"},{default:d((()=>[f(o,null,{default:d((()=>[m("æš‚æ— ç« èŠ‚")])),_:1})])),_:1}))])),_:1}),f(l,{class:"action-bar"},{default:d((()=>[f(l,{class:"action-container"},{default:d((()=>[N(k).isLogin?(r(),u(l,{key:0,class:"credit-info"},{default:d((()=>[f(l,{class:"credit-icon"},{default:d((()=>[f(Y,{name:"star",size:40,color:"#C8161D"})])),_:1}),f(l,{class:"credit-content"},{default:d((()=>[f(o,{class:"credit-label"},{default:d((()=>[m("å‰©ä½™å­¦åˆ†")])),_:1}),f(o,{class:"credit-value"},{default:d((()=>[m(v(N(k).remainingCredits),1)])),_:1})])),_:1})])),_:1})):g("",!0),f(l,{class:"action-btns"},{default:d((()=>[s.value.isEnrolled&&"COMPLETED"!==s.value.enrollmentStatus?(r(),u(l,{key:0,class:"enrolled-actions"},{default:d((()=>[f(n,{class:"btn-enrolled-tag",disabled:""},{default:d((()=>[f(Y,{name:"check",size:28,color:"#52C41A"}),f(o,null,{default:d((()=>[m("è¿›è¡Œä¸­")])),_:1})])),_:1}),"PENDING"===s.value.refundStatus?(r(),u(n,{key:0,class:"btn-refunding",disabled:""},{default:d((()=>[f(Y,{name:"time",size:28,color:"#FF9800"}),f(o,null,{default:d((()=>[m("é€€è¯¾å®¡æ ¸ä¸­")])),_:1})])),_:1})):g("",!0),"APPROVED"!==s.value.refundStatus&&K.value.hasActiveSession&&!K.value.alreadyCheckedIn?(r(),u(n,{key:1,class:"btn-checkin",onClick:ce},{default:d((()=>[f(Y,{name:"check",size:32,color:"#fff"}),f(o,null,{default:d((()=>[m("ç«‹å³ç­¾åˆ°")])),_:1})])),_:1})):g("",!0),s.value.refundStatus?g("",!0):(r(),u(l,{key:2,class:"more-actions"},{default:d((()=>[fe.value?(r(),u(n,{key:0,class:"btn-refund",onClick:he},{default:d((()=>[m(" é€€è¯¾ ")])),_:1})):g("",!0),f(n,{class:"btn-gift",onClick:me},{default:d((()=>[m(" èµ é€ ")])),_:1})])),_:1}))])),_:1})):s.value.isEnrolled&&"COMPLETED"===s.value.enrollmentStatus?(r(),u(l,{key:1,class:"enrolled-actions"},{default:d((()=>[f(n,{class:"btn-completed-tag",disabled:""},{default:d((()=>[f(Y,{name:"check",size:28,color:"#1890FF"}),f(o,null,{default:d((()=>[m("å·²å®Œæˆ")])),_:1})])),_:1}),f(n,{class:"btn-poster",onClick:_e},{default:d((()=>[f(Y,{name:"star",size:24,color:"#fff"}),m(" ç»“è¯¾æµ·æŠ¥ ")])),_:1})])),_:1})):"CLOSED"===s.value.enrollStatus?(r(),u(n,{key:2,class:"btn-closed",disabled:""},{default:d((()=>[f(Y,{name:"close",size:36,color:"#fff"}),f(o,null,{default:d((()=>[m("å·²æˆªæ­¢")])),_:1})])),_:1})):(r(),u(n,{key:3,class:"btn-enroll",onClick:re},{default:d((()=>[f(Y,{name:"star",size:36,color:"#fff"}),f(o,null,{default:d((()=>[m("ç«‹å³æŠ¥å")])),_:1})])),_:1}))])),_:1})])),_:1})])),_:1}),Q.value?(r(),u(l,{key:0,class:"popup-mask",onClick:ne},{default:d((()=>[f(l,{class:"checkin-modal",onClick:t[1]||(t[1]=h((()=>{}),["stop"]))},{default:d((()=>[f(l,{class:"modal-title"},{default:d((()=>[m("ç« èŠ‚ç­¾åˆ°")])),_:1}),f(l,{class:"modal-subtitle"},{default:d((()=>[m("è¯·è¾“å…¥è€å¸ˆå‘ŠçŸ¥çš„6ä½æ•°å­—ç­¾åˆ°ç ")])),_:1}),f(l,{class:"code-input-section"},{default:d((()=>[f(i,{modelValue:ee.value,"onUpdate:modelValue":t[0]||(t[0]=e=>ee.value=e),type:"number",maxlength:"6",placeholder:"è¯·è¾“å…¥6ä½ç­¾åˆ°ç ",class:"code-input",onConfirm:ie},null,8,["modelValue"]),f(n,{class:"btn-submit-code",onClick:ie},{default:d((()=>[m("ç«‹å³ç­¾åˆ°")])),_:1})])),_:1}),f(n,{class:"btn-cancel-modal",onClick:ne},{default:d((()=>[m(" å–æ¶ˆ ")])),_:1})])),_:1})])),_:1})):g("",!0),f(Z,{visible:te.value,posterData:ae.value,onClose:ge,onShare:Ce,onConfirm:pe},null,8,["visible","posterData"])])),_:1})}}},[["__scopeId","data-v-53911d91"]]);export{K as default};
