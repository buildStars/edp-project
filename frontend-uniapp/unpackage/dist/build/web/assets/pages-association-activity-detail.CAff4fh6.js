import{r as a,u as e,G as l,H as t,x as s,I as i,J as c,K as o,c as u,w as n,i as r,d as v,e as d,k as m,t as f,L as _,A as p,z as h,M as k}from"./index-Cljxm-NV.js";import{e as g,u as w,l as y}from"./association.BZuSzsP7.js";import{f as x}from"./util.DiFpgDCN.js";import{I}from"./icon.DkV2kXZZ.js";import{_ as j}from"./_plugin-vue_export-helper.BCo6x5W8.js";const z=j({__name:"activity-detail",setup(j){const z=a({title:"",publishTime:"",views:0,content:"",likes:0,coverImage:""}),b=a(""),L=a(!1),M=e();l((a=>{a.id&&(b.value=a.id,T())}));const T=async()=>{t({title:"加载中..."});try{const a=await g(b.value);z.value=a,L.value=a.isLiked||!1}catch(a){console.error("加载详情失败：",a),s({title:"加载失败",icon:"none"})}finally{i()}},A=async()=>{if(M.checkLogin())try{L.value?(await w(b.value),L.value=!1,z.value.likes=(z.value.likes||1)-1):(await y(b.value),L.value=!0,z.value.likes=(z.value.likes||0)+1)}catch(a){console.error("操作失败：",a)}},C=()=>{uni.showShareMenu({withShareTicket:!0,menus:["shareAppMessage","shareTimeline"]})};return c((()=>{var a;return{title:z.value.title||"北大汇丰EDP活动",path:`/pages/association/activity-detail?id=${b.value}`,imageUrl:z.value.coverImage||(null==(a=z.value.images)?void 0:a[0])||""}})),o((()=>{var a;return{title:z.value.title||"北大汇丰EDP活动",query:`id=${b.value}`,imageUrl:z.value.coverImage||(null==(a=z.value.images)?void 0:a[0])||""}})),(a,e)=>{const l=r,t=h,s=k;return v(),u(l,{class:"page"},{default:n((()=>[d(l,{class:"activity-header"},{default:n((()=>[d(l,{class:"header-decoration"}),d(l,{class:"activity-title"},{default:n((()=>[m(f(z.value.title),1)])),_:1}),d(l,{class:"activity-meta"},{default:n((()=>[d(l,{class:"meta-item"},{default:n((()=>[d(I,{name:"time",size:32,color:"#999"}),d(t,{class:"meta-text"},{default:n((()=>[m(f(_(x)(z.value.publishTime)),1)])),_:1})])),_:1}),d(l,{class:"meta-divider"}),d(l,{class:"meta-item"},{default:n((()=>[d(I,{name:"view",size:32,color:"#999"}),d(t,{class:"meta-text"},{default:n((()=>[m(f(z.value.views||0)+" 阅读",1)])),_:1})])),_:1})])),_:1})])),_:1}),d(l,{class:"activity-content"},{default:n((()=>[d(l,{class:"content-wrapper"},{default:n((()=>[d(s,{nodes:z.value.content},null,8,["nodes"])])),_:1})])),_:1}),d(l,{class:"action-bar"},{default:n((()=>[d(l,{class:"action-container"},{default:n((()=>[d(l,{class:"action-item",onClick:A},{default:n((()=>[d(l,{class:p(["action-icon-wrapper",{liked:L.value}])},{default:n((()=>[d(I,{name:L.value?"liked":"like",size:48,color:L.value?"#fff":"#666"},null,8,["name","color"])])),_:1},8,["class"]),d(t,{class:p(["action-text",{liked:L.value}])},{default:n((()=>[m(f(L.value?"已点赞":"点赞")+" ("+f(z.value.likes||0)+") ",1)])),_:1},8,["class"])])),_:1}),d(l,{class:"action-divider"}),d(l,{class:"action-item",onClick:C},{default:n((()=>[d(l,{class:"action-icon-wrapper"},{default:n((()=>[d(I,{name:"share",size:48,color:"#666"})])),_:1}),d(t,{class:"action-text"},{default:n((()=>[m("分享")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-32ab1457"]]);export{z as default};
