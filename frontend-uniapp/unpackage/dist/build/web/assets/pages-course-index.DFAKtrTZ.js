import{r as e,u as a,D as s,o as l,x as t,s as o,b as u,E as r,c as i,w as c,i as n,d,e as _,k as p,h as v,j as f,F as m,f as g,z as y,n as x,l as h}from"./index-Cljxm-NV.js";import{u as j}from"./course.CDyzUl-1.js";import{C as k}from"./course-card.BdimI_jI.js";import{E as w}from"./empty-view.C6sbClhI.js";import{_ as C}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./util.DiFpgDCN.js";/* empty css                                                                    *//* empty css                                                                   */const L=C({__name:"index",setup(C){const L=e(!1),E=e(1),b=e(10),z=e(!0),F=j(),D=a(),I=s((()=>F.courseList));l((()=>{M(!0)}));const M=async(e=!1)=>{if(!L.value){L.value=!0,e&&(E.value=1,z.value=!0);try{const a={page:E.value,pageSize:b.value},s=await F.fetchCourseList(a);(s.items||s.data||s.list||[]).length<b.value&&(z.value=!1),E.value++}catch(a){console.error("加载课程失败：",a),t({title:"加载失败",icon:"none"})}finally{L.value=!1,e&&o()}}},N=()=>{F.clearCourseList(),M(!0)},O=e=>{h({url:`/pages/course/detail?id=${e.id}`})},P=e=>{D.checkLogin()&&O(e)};return u((()=>{N()})),r((()=>{z.value&&!L.value&&M(!1)})),(e,a)=>{const s=n,l=y;return d(),i(s,{class:"page"},{default:c((()=>[_(s,{class:"page-header-decoration"}),_(s,{class:"page-title"},{default:c((()=>[_(l,{class:"title-text"},{default:c((()=>[p("课程中心")])),_:1}),_(l,{class:"title-desc"},{default:c((()=>[p("精品课程 · 助力成长")])),_:1})])),_:1}),_(s,{class:"course-list"},{default:c((()=>[(d(!0),v(m,null,f(I.value,((e,a)=>(d(),i(s,{key:e.id,class:"course-item-wrapper",style:x({"animation-delay":.1*a+"s"})},{default:c((()=>[_(k,{course:e,onClick:O,onEnroll:P},null,8,["course"])])),_:2},1032,["style"])))),128)),L.value||0!==I.value.length?g("",!0):(d(),i(w,{key:0,text:"暂无课程","show-btn":!0,onClick:N})),L.value?(d(),i(s,{key:1,class:"loading-more"},{default:c((()=>[_(s,{class:"loading-spinner"}),_(l,{class:"loading-text"},{default:c((()=>[p("加载中...")])),_:1})])),_:1})):g("",!0),!z.value&&I.value.length>0?(d(),i(s,{key:2,class:"no-more"},{default:c((()=>[_(s,{class:"no-more-line"}),_(l,{class:"no-more-text"},{default:c((()=>[p("已经到底了")])),_:1}),_(s,{class:"no-more-line"})])),_:1})):g("",!0)])),_:1})])),_:1})}}},[["__scopeId","data-v-98fff552"]]);export{L as default};
