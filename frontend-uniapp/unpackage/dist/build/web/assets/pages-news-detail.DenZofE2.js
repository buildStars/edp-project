import{r as e,u as a,B as l,C as s,m as t,D as i,E as c,G as o,c as u,w as n,i as r,d as v,e as d,k as m,t as f,H as _,v as p,q as g,I as h}from"./index-BA-OeFd4.js";import{a as w,u as y,c as I}from"./news.DNtdDH2m.js";import{f as j}from"./util.SBHl27LX.js";import{I as k}from"./icon.DZSIreks.js";import{_ as b}from"./_plugin-vue_export-helper.BCo6x5W8.js";const C=b({__name:"detail",setup(b){const C=e({title:"",publishTime:"",views:0,category:"",content:"",coverImage:""}),T=e(""),x=e(!1),D=a();l((e=>{e.id&&(T.value=e.id,E())}));const E=async()=>{s({title:"加载中..."});try{const e=await w(T.value);C.value=e,x.value=e.isCollected||!1}catch(e){console.error("加载资讯详情失败：",e),t({title:"加载失败",icon:"none"})}finally{i()}},M=async()=>{if(D.checkLogin())try{if(x.value){const e=await y(T.value);x.value=!1,t({title:(null==e?void 0:e.message)||"已取消收藏",icon:"success"})}else{const e=await I(T.value);x.value=!0,t({title:(null==e?void 0:e.message)||"收藏成功",icon:"success"})}}catch(e){console.error("操作失败：",e),t({title:"操作失败",icon:"none"})}},q=()=>{uni.showShareMenu({withShareTicket:!0,menus:["shareAppMessage","shareTimeline"]})};return c((()=>({title:C.value.title||"北大汇丰EDP",path:`/pages/news/detail?id=${T.value}`,imageUrl:C.value.coverImage}))),o((()=>({title:C.value.title||"北大汇丰EDP",query:`id=${T.value}`,imageUrl:C.value.coverImage}))),(e,a)=>{const l=r,s=g,t=h;return v(),u(l,{class:"page"},{default:n((()=>[d(l,{class:"article-header"},{default:n((()=>[d(l,{class:"article-title"},{default:n((()=>[m(f(C.value.title),1)])),_:1}),d(l,{class:"article-meta"},{default:n((()=>[d(l,{class:"meta-left"},{default:n((()=>[d(s,{class:"time"},{default:n((()=>[m(f(_(j)(C.value.publishTime)),1)])),_:1}),d(s,{class:"views"},{default:n((()=>[m(f(C.value.views||0)+" 阅读",1)])),_:1})])),_:1}),d(l,{class:"category-tag"},{default:n((()=>{return[m(f((e=C.value.category,{notice:"学院通知",alumni:"校友动态"}[e]||"")),1)];var e})),_:1})])),_:1})])),_:1}),d(l,{class:"article-content"},{default:n((()=>[d(t,{nodes:C.value.content},null,8,["nodes"])])),_:1}),d(l,{class:"action-bar"},{default:n((()=>[d(l,{class:"action-item",onClick:M},{default:n((()=>[d(k,{name:x.value?"star":"star-o",size:48,color:x.value?"#FFB400":"#666"},null,8,["name","color"]),d(s,{class:p({collected:x.value})},{default:n((()=>[m(f(x.value?"已收藏":"收藏"),1)])),_:1},8,["class"])])),_:1}),d(l,{class:"action-item",onClick:q},{default:n((()=>[d(k,{name:"share",size:48,color:"#666"}),d(s,null,{default:n((()=>[m("分享")])),_:1})])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-eb88089a"]]);export{C as default};
