import{r as a,u as e,B as l,C as t,m as s,D as i,E as c,G as o,c as u,w as n,i as r,d as v,e as d,k as m,t as f,H as _,v as p,q as h,I as k}from"./index-CCW0MaS3.js";import{c as g,u as w,l as y}from"./association.DOj8Rd0-.js";import{f as x}from"./util.BUrGU9NL.js";import{I}from"./icon.Br2I0aeN.js";import{_ as j}from"./_plugin-vue_export-helper.BCo6x5W8.js";const b=j({__name:"activity-detail",setup(j){const b=a({title:"",publishTime:"",views:0,content:"",likes:0,coverImage:""}),z=a(""),T=a(!1),C=e();l((a=>{a.id&&(z.value=a.id,D())}));const D=async()=>{t({title:"加载中..."});try{const a=await g(z.value);b.value=a,T.value=a.isLiked||!1}catch(a){console.error("加载详情失败：",a),s({title:"加载失败",icon:"none"})}finally{i()}},E=async()=>{if(C.checkLogin())try{T.value?(await w(z.value),T.value=!1,b.value.likes=(b.value.likes||1)-1):(await y(z.value),T.value=!0,b.value.likes=(b.value.likes||0)+1)}catch(a){console.error("操作失败：",a)}},L=()=>{uni.showShareMenu({withShareTicket:!0,menus:["shareAppMessage","shareTimeline"]})};return c((()=>{var a;return{title:b.value.title||"北大汇丰EDP活动",path:`/pages/association/activity-detail?id=${z.value}`,imageUrl:b.value.coverImage||(null==(a=b.value.images)?void 0:a[0])||""}})),o((()=>{var a;return{title:b.value.title||"北大汇丰EDP活动",query:`id=${z.value}`,imageUrl:b.value.coverImage||(null==(a=b.value.images)?void 0:a[0])||""}})),(a,e)=>{const l=r,t=h,s=k;return v(),u(l,{class:"page"},{default:n((()=>[d(l,{class:"activity-header"},{default:n((()=>[d(l,{class:"header-decoration"}),d(l,{class:"activity-title"},{default:n((()=>[m(f(b.value.title),1)])),_:1}),d(l,{class:"activity-meta"},{default:n((()=>[d(l,{class:"meta-item"},{default:n((()=>[d(I,{name:"time",size:32,color:"#999"}),d(t,{class:"meta-text"},{default:n((()=>[m(f(_(x)(b.value.publishTime)),1)])),_:1})])),_:1}),d(l,{class:"meta-divider"}),d(l,{class:"meta-item"},{default:n((()=>[d(I,{name:"view",size:32,color:"#999"}),d(t,{class:"meta-text"},{default:n((()=>[m(f(b.value.views||0)+" 阅读",1)])),_:1})])),_:1})])),_:1})])),_:1}),d(l,{class:"activity-content"},{default:n((()=>[d(l,{class:"content-wrapper"},{default:n((()=>[d(s,{nodes:b.value.content},null,8,["nodes"])])),_:1})])),_:1}),d(l,{class:"action-bar"},{default:n((()=>[d(l,{class:"action-container"},{default:n((()=>[d(l,{class:"action-item",onClick:E},{default:n((()=>[d(l,{class:p(["action-icon-wrapper",{liked:T.value}])},{default:n((()=>[d(I,{name:T.value?"liked":"like",size:48,color:T.value?"#fff":"#666"},null,8,["name","color"])])),_:1},8,["class"]),d(t,{class:p(["action-text",{liked:T.value}])},{default:n((()=>[m(f(T.value?"已点赞":"点赞")+" ("+f(b.value.likes||0)+") ",1)])),_:1},8,["class"])])),_:1}),d(l,{class:"action-divider"}),d(l,{class:"action-item",onClick:L},{default:n((()=>[d(l,{class:"action-icon-wrapper"},{default:n((()=>[d(I,{name:"share",size:48,color:"#666"})])),_:1}),d(t,{class:"action-text"},{default:n((()=>[m("分享")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-32ab1457"]]);export{b as default};
