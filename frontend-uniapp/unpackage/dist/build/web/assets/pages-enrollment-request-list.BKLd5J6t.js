import{r as a,B as e,a3 as s,m as l,c as t,w as c,i as u,d as o,e as r,h as i,j as n,F as d,k as v,f,p as _,q as m,v as p,t as E,H as y,N as b,C as g,D as k,T as w}from"./index-BA-OeFd4.js";import{_ as D}from"./empty.CQuSoWib.js";import{g as N,a as P}from"./enrollment-request.B1vVR5Dz.js";import{f as C}from"./util.SBHl27LX.js";import{_ as j}from"./_plugin-vue_export-helper.BCo6x5W8.js";const A=j({__name:"list",setup(j){const A=[{label:"全部",value:""},{label:"待审批",value:"PENDING"},{label:"已通过",value:"APPROVED"},{label:"已拒绝",value:"REJECTED"}],I=a(""),R=a([]),h=a(!1);e((()=>{x()})),s((()=>{x()}));const x=async()=>{try{h.value=!0;const a={page:1,pageSize:50};I.value&&(a.status=I.value);const e=await N(a);R.value=e.list||[],h.value=!1}catch(a){h.value=!1,l({title:a.msg||"加载失败",icon:"none"})}},G=a=>({PENDING:"待审批",APPROVED:"已通过",REJECTED:"已拒绝"}[a]||a);return(a,e)=>{const s=u,N=_,j=m,T=w;return o(),t(s,{class:"page"},{default:c((()=>[r(s,{class:"tabs"},{default:c((()=>[(o(),i(d,null,n(A,(a=>r(s,{key:a.value,class:p(["tab",{active:I.value===a.value}]),onClick:e=>{return s=a.value,I.value=s,void x();var s}},{default:c((()=>[v(E(a.label),1)])),_:2},1032,["class","onClick"]))),64))])),_:1}),r(s,{class:"list"},{default:c((()=>[(o(!0),i(d,null,n(R.value,(a=>(o(),t(s,{key:a.id,class:"item"},{default:c((()=>[r(N,{src:a.course.coverImage,class:"cover",mode:"aspectFill"},null,8,["src"]),r(s,{class:"content"},{default:c((()=>[r(j,{class:"course-name"},{default:c((()=>[v(E(a.course.title),1)])),_:2},1024),r(s,{class:"info-row"},{default:c((()=>[r(j,{class:"label"},{default:c((()=>[v("需要学分：")])),_:1}),r(j,{class:"value"},{default:c((()=>[v(E(a.course.credit),1)])),_:2},1024)])),_:2},1024),r(s,{class:"info-row"},{default:c((()=>[r(j,{class:"label"},{default:c((()=>[v("申请时间：")])),_:1}),r(j,{class:"value"},{default:c((()=>[v(E(y(C)(a.createdAt)),1)])),_:2},1024)])),_:2},1024),r(s,{class:"status-row"},{default:c((()=>{return[r(j,{class:p(["status-tag",(e=a.status,{PENDING:"pending",APPROVED:"approved",REJECTED:"rejected"}[e]||"")])},{default:c((()=>[v(E(G(a.status)),1)])),_:2},1032,["class"]),a.reviewedAt?(o(),t(j,{key:0,class:"review-time"},{default:c((()=>[v(E(y(C)(a.reviewedAt)),1)])),_:2},1024)):f("",!0)];var e})),_:2},1024),a.reviewNote?(o(),t(s,{key:0,class:"note"},{default:c((()=>[r(j,{class:"note-label"},{default:c((()=>[v("备注：")])),_:1}),r(j,{class:"note-text"},{default:c((()=>[v(E(a.reviewNote),1)])),_:2},1024)])),_:2},1024)):f("",!0)])),_:2},1024),"PENDING"===a.status?(o(),t(s,{key:0,class:"actions"},{default:c((()=>[r(T,{class:"btn-cancel",onClick:e=>{return s=a.id,void b({title:"确认取消",content:"确定要取消这个申请吗？",success:async a=>{if(a.confirm)try{g({title:"取消中..."}),await P(s),k(),l({title:"已取消",icon:"success"}),x()}catch(e){k(),l({title:e.msg||"取消失败",icon:"none"})}}});var s}},{default:c((()=>[v("取消")])),_:2},1032,["onClick"])])),_:2},1024)):f("",!0)])),_:2},1024)))),128)),h.value||0!==R.value.length?f("",!0):(o(),t(s,{key:0,class:"empty"},{default:c((()=>[r(N,{src:D,class:"empty-img",mode:"aspectFit"}),r(j,{class:"empty-text"},{default:c((()=>[v("暂无申请记录")])),_:1})])),_:1}))])),_:1}),h.value?(o(),t(s,{key:0,class:"loading"},{default:c((()=>[r(j,null,{default:c((()=>[v("加载中...")])),_:1})])),_:1})):f("",!0)])),_:1})}}},[["__scopeId","data-v-dbb36e91"]]);export{A as default};
