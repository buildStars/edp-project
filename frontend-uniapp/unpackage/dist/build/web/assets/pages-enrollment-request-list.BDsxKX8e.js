import{r as a,G as e,N as s,x as l,c as t,w as c,i as u,d as o,e as r,h as i,j as n,F as d,k as f,f as v,y as _,z as m,A as p,t as y,L as E,Q as g,H as k,I as b,R as w}from"./index-Cljxm-NV.js";import{_ as N}from"./empty.Dy77HuBL.js";import{g as D,a as P}from"./enrollment-request.Dr-R5cxm.js";import{f as j}from"./util.DiFpgDCN.js";import{_ as A}from"./_plugin-vue_export-helper.BCo6x5W8.js";const C=A({__name:"list",setup(A){const C=[{label:"全部",value:""},{label:"待审批",value:"PENDING"},{label:"已通过",value:"APPROVED"},{label:"已拒绝",value:"REJECTED"}],I=a(""),R=a([]),x=a(!1);e((()=>{h()})),s((()=>{h()}));const h=async()=>{try{x.value=!0;const a={page:1,pageSize:50};I.value&&(a.status=I.value);const e=await D(a);R.value=e.list||[],x.value=!1}catch(a){x.value=!1,l({title:a.msg||"加载失败",icon:"none"})}},G=a=>({PENDING:"待审批",APPROVED:"已通过",REJECTED:"已拒绝"}[a]||a);return(a,e)=>{const s=u,D=_,A=m,F=w;return o(),t(s,{class:"page"},{default:c((()=>[r(s,{class:"tabs"},{default:c((()=>[(o(),i(d,null,n(C,(a=>r(s,{key:a.value,class:p(["tab",{active:I.value===a.value}]),onClick:e=>{return s=a.value,I.value=s,void h();var s}},{default:c((()=>[f(y(a.label),1)])),_:2},1032,["class","onClick"]))),64))])),_:1}),r(s,{class:"list"},{default:c((()=>[(o(!0),i(d,null,n(R.value,(a=>(o(),t(s,{key:a.id,class:"item"},{default:c((()=>[r(D,{src:a.course.coverImage,class:"cover",mode:"aspectFill"},null,8,["src"]),r(s,{class:"content"},{default:c((()=>[r(A,{class:"course-name"},{default:c((()=>[f(y(a.course.title),1)])),_:2},1024),r(s,{class:"info-row"},{default:c((()=>[r(A,{class:"label"},{default:c((()=>[f("需要学分：")])),_:1}),r(A,{class:"value"},{default:c((()=>[f(y(a.course.credit),1)])),_:2},1024)])),_:2},1024),r(s,{class:"info-row"},{default:c((()=>[r(A,{class:"label"},{default:c((()=>[f("申请时间：")])),_:1}),r(A,{class:"value"},{default:c((()=>[f(y(E(j)(a.createdAt)),1)])),_:2},1024)])),_:2},1024),r(s,{class:"status-row"},{default:c((()=>{return[r(A,{class:p(["status-tag",(e=a.status,{PENDING:"pending",APPROVED:"approved",REJECTED:"rejected"}[e]||"")])},{default:c((()=>[f(y(G(a.status)),1)])),_:2},1032,["class"]),a.reviewedAt?(o(),t(A,{key:0,class:"review-time"},{default:c((()=>[f(y(E(j)(a.reviewedAt)),1)])),_:2},1024)):v("",!0)];var e})),_:2},1024),a.reviewNote?(o(),t(s,{key:0,class:"note"},{default:c((()=>[r(A,{class:"note-label"},{default:c((()=>[f("备注：")])),_:1}),r(A,{class:"note-text"},{default:c((()=>[f(y(a.reviewNote),1)])),_:2},1024)])),_:2},1024)):v("",!0)])),_:2},1024),"PENDING"===a.status?(o(),t(s,{key:0,class:"actions"},{default:c((()=>[r(F,{class:"btn-cancel",onClick:e=>{return s=a.id,void g({title:"确认取消",content:"确定要取消这个申请吗？",success:async a=>{if(a.confirm)try{k({title:"取消中..."}),await P(s),b(),l({title:"已取消",icon:"success"}),h()}catch(e){b(),l({title:e.msg||"取消失败",icon:"none"})}}});var s}},{default:c((()=>[f("取消")])),_:2},1032,["onClick"])])),_:2},1024)):v("",!0)])),_:2},1024)))),128)),x.value||0!==R.value.length?v("",!0):(o(),t(s,{key:0,class:"empty"},{default:c((()=>[r(D,{src:N,class:"empty-img",mode:"aspectFit"}),r(A,{class:"empty-text"},{default:c((()=>[f("暂无申请记录")])),_:1})])),_:1}))])),_:1}),x.value?(o(),t(s,{key:0,class:"loading"},{default:c((()=>[r(A,null,{default:c((()=>[f("加载中...")])),_:1})])),_:1})):v("",!0)])),_:1})}}},[["__scopeId","data-v-130a05dd"]]);export{C as default};
