import{r as e,u as a,G as l,H as s,x as t,I as i,J as c,K as o,c as u,w as n,i as r,d as v,e as d,k as m,t as f,L as _,A as p,z as g,M as h}from"./index-Cljxm-NV.js";import{a as w,u as y,c as I}from"./news.DJfprz8c.js";import{f as j}from"./util.DiFpgDCN.js";import{I as k}from"./icon.DkV2kXZZ.js";import{_ as b}from"./_plugin-vue_export-helper.BCo6x5W8.js";const x=b({__name:"detail",setup(b){const x=e({title:"",publishTime:"",views:0,category:"",content:"",coverImage:""}),M=e(""),T=e(!1),z=a();l((e=>{e.id&&(M.value=e.id,C())}));const C=async()=>{s({title:"加载中..."});try{const e=await w(M.value);x.value=e,T.value=e.isCollected||!1}catch(e){console.error("加载资讯详情失败：",e),t({title:"加载失败",icon:"none"})}finally{i()}},L=async()=>{if(z.checkLogin())try{if(T.value){const e=await y(M.value);T.value=!1,t({title:(null==e?void 0:e.message)||"已取消收藏",icon:"success"})}else{const e=await I(M.value);T.value=!0,t({title:(null==e?void 0:e.message)||"收藏成功",icon:"success"})}}catch(e){console.error("操作失败：",e),t({title:"操作失败",icon:"none"})}},A=()=>{uni.showShareMenu({withShareTicket:!0,menus:["shareAppMessage","shareTimeline"]})};return c((()=>({title:x.value.title||"北大汇丰EDP",path:`/pages/news/detail?id=${M.value}`,imageUrl:x.value.coverImage}))),o((()=>({title:x.value.title||"北大汇丰EDP",query:`id=${M.value}`,imageUrl:x.value.coverImage}))),(e,a)=>{const l=r,s=g,t=h;return v(),u(l,{class:"page"},{default:n((()=>[d(l,{class:"article-header"},{default:n((()=>[d(l,{class:"article-title"},{default:n((()=>[m(f(x.value.title),1)])),_:1}),d(l,{class:"article-meta"},{default:n((()=>[d(l,{class:"meta-left"},{default:n((()=>[d(s,{class:"time"},{default:n((()=>[m(f(_(j)(x.value.publishTime)),1)])),_:1}),d(s,{class:"views"},{default:n((()=>[m(f(x.value.views||0)+" 阅读",1)])),_:1})])),_:1}),d(l,{class:"category-tag"},{default:n((()=>{return[m(f((e=x.value.category,{notice:"学院通知",alumni:"校友动态"}[e]||"")),1)];var e})),_:1})])),_:1})])),_:1}),d(l,{class:"article-content"},{default:n((()=>[d(t,{nodes:x.value.content},null,8,["nodes"])])),_:1}),d(l,{class:"action-bar"},{default:n((()=>[d(l,{class:"action-item",onClick:L},{default:n((()=>[d(k,{name:T.value?"star":"star-o",size:48,color:T.value?"#FFB400":"#666"},null,8,["name","color"]),d(s,{class:p({collected:T.value})},{default:n((()=>[m(f(T.value?"已收藏":"收藏"),1)])),_:1},8,["class"])])),_:1}),d(l,{class:"action-item",onClick:A},{default:n((()=>[d(k,{name:"share",size:48,color:"#666"}),d(s,null,{default:n((()=>[m("分享")])),_:1})])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-eb88089a"]]);export{x as default};
