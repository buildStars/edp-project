import{r as e,o as s,g as a,x as l,c as t,w as c,i as d,d as o,e as i,n as r,k as u,t as n,f as _,h as m,j as f,F as v,z as p,A as y,L as g,y as h}from"./index-Cljxm-NV.js";import{a as b}from"./checkin.Cos8j2KI.js";import{f as k}from"./util.DiFpgDCN.js";import{C as M}from"./custom-navbar.DLfdosCP.js";import{E as w}from"./empty-view.C6sbClhI.js";import{I as x}from"./icon.DkV2kXZZ.js";import{_ as Y}from"./_plugin-vue_export-helper.BCo6x5W8.js";/* empty css                                                                      *//* empty css                                                                   */const z=Y({__name:"records",setup(Y){const z=e(88),D=e(!1),j=e(null),L=e([]);s((()=>{const e=a().statusBarHeight||0;z.value=e+44,C()}));const C=async()=>{if(!D.value){D.value=!0;try{const e=await b();j.value=e.summary,L.value=e.records,console.log("âœ… ç­¾åˆ°è®°å½•åŠ è½½æˆåŠŸ:",e),console.log("ðŸ“Š ç»Ÿè®¡ä¿¡æ¯:",e.summary),console.log("ðŸ“‹ è®°å½•è¯¦æƒ…:"),e.records.forEach(((e,s)=>{console.log(`  [${s}] ${e.isMissed?"âŒç¼ºå‹¤":e.isLate?"ðŸŸ¡è¿Ÿåˆ°":"âœ…å‡†æ—¶"} - ${e.course.title}`),console.log(`       isMissed: ${e.isMissed}, isLate: ${e.isLate}`)}))}catch(e){console.error("âŒ åŠ è½½ç­¾åˆ°è®°å½•å¤±è´¥:",e),l({title:e.msg||"åŠ è½½å¤±è´¥",icon:"none"})}finally{D.value=!1}}},H=e=>e.isMissed?"ç¼ºå‹¤":e.isLate?"è¿Ÿåˆ°":"å‡†æ—¶",$=e=>e.isMissed?"badge-missed":e.isLate?"badge-late":"badge-ontime";return(e,s)=>{const a=d,l=p,b=h;return o(),t(a,{class:"page"},{default:c((()=>[i(M,{title:"ç­¾åˆ°è®°å½•","show-back":!0}),i(a,{class:"navbar-placeholder",style:r({height:z.value+"px"})},null,8,["style"]),j.value?(o(),t(a,{key:0,class:"summary-card"},{default:c((()=>[i(a,{class:"summary-header"},{default:c((()=>[i(x,{name:"calendar",size:48,color:"#C8161D"}),i(l,{class:"summary-title"},{default:c((()=>[u("æˆ‘çš„ç­¾åˆ°ç»Ÿè®¡")])),_:1})])),_:1}),i(a,{class:"summary-grid"},{default:c((()=>[i(a,{class:"stat-item"},{default:c((()=>[i(a,{class:"stat-value"},{default:c((()=>[u(n(j.value.totalSessions||0),1)])),_:1}),i(a,{class:"stat-label"},{default:c((()=>[u("æ€»ä¼šè¯")])),_:1})])),_:1}),i(a,{class:"stat-divider"}),i(a,{class:"stat-item"},{default:c((()=>[i(a,{class:"stat-value success"},{default:c((()=>[u(n(j.value.onTimeCheckins||0),1)])),_:1}),i(a,{class:"stat-label"},{default:c((()=>[u("å‡†æ—¶")])),_:1})])),_:1}),i(a,{class:"stat-divider"}),i(a,{class:"stat-item"},{default:c((()=>[i(a,{class:"stat-value warning"},{default:c((()=>[u(n(j.value.lateCheckins||0),1)])),_:1}),i(a,{class:"stat-label"},{default:c((()=>[u("è¿Ÿåˆ°")])),_:1})])),_:1}),i(a,{class:"stat-divider"}),i(a,{class:"stat-item"},{default:c((()=>[i(a,{class:"stat-value error"},{default:c((()=>[u(n(j.value.missedCheckins||0),1)])),_:1}),i(a,{class:"stat-label"},{default:c((()=>[u("ç¼ºå‹¤")])),_:1})])),_:1})])),_:1})])),_:1})):_("",!0),i(a,{class:"records-section"},{default:c((()=>[(o(!0),m(v,null,f(L.value,((e,s)=>(o(),t(a,{key:`${e.id}-${s}`,class:"record-card"},{default:c((()=>[i(l,{style:{"font-size":"20rpx",color:"#999",display:"block","margin-bottom":"10rpx"}},{default:c((()=>[u(" Debug: isMissed="+n(e.isMissed)+", isLate="+n(e.isLate),1)])),_:2},1024),i(a,{class:"record-header"},{default:c((()=>[i(a,{class:"course-info"},{default:c((()=>[e.course.coverImage?(o(),t(b,{key:0,src:e.course.coverImage,class:"course-cover",mode:"aspectFill"},null,8,["src"])):(o(),t(a,{key:1,class:"course-cover-placeholder"},{default:c((()=>[i(x,{name:"course",size:48,color:"#C8161D"})])),_:1})),i(a,{class:"course-detail"},{default:c((()=>[i(a,{class:"course-title"},{default:c((()=>[u(n(e.course.title),1)])),_:2},1024),e.chapter?(o(),t(a,{key:0,class:"chapter-title"},{default:c((()=>[u(" ç¬¬"+n(e.chapter.sortOrder)+"èŠ‚ Â· "+n(e.chapter.title),1)])),_:2},1024)):_("",!0)])),_:2},1024)])),_:2},1024),i(a,{class:y(["status-badge",$(e)])},{default:c((()=>[u(n(H(e)),1)])),_:2},1032,["class"])])),_:2},1024),i(a,{class:"record-body"},{default:c((()=>[e.isMissed?(o(),m(v,{key:0},[i(a,{class:"missed-notice"},{default:c((()=>[i(x,{name:"close",size:32,color:"#F44336"}),i(l,{class:"missed-text"},{default:c((()=>[u("æœªå‚ä¸Žæœ¬æ¬¡ç­¾åˆ°")])),_:1})])),_:1}),i(a,{class:"detail-row"},{default:c((()=>[i(x,{name:"time",size:32,color:"#F44336"}),i(l,{class:"detail-label"},{default:c((()=>[u("ç¼ºå‹¤æ—¶é—´")])),_:1}),i(l,{class:"detail-value error"},{default:c((()=>[u(n(g(k)(e.sessionEndTime,"YYYY-MM-DD HH:mm:ss")),1)])),_:2},1024)])),_:2},1024),i(a,{class:"detail-row"},{default:c((()=>[i(x,{name:"order",size:32,color:"#999"}),i(l,{class:"detail-label"},{default:c((()=>[u("ç­¾åˆ°ç ")])),_:1}),i(l,{class:"detail-value code disabled"},{default:c((()=>[u(n(e.code),1)])),_:2},1024)])),_:2},1024)],64)):(o(),m(v,{key:1},[i(a,{class:"detail-row"},{default:c((()=>[i(x,{name:"time",size:32,color:"#999"}),i(l,{class:"detail-label"},{default:c((()=>[u("ç­¾åˆ°æ—¶é—´")])),_:1}),i(l,{class:"detail-value"},{default:c((()=>[u(n(g(k)(e.checkinTime,"YYYY-MM-DD HH:mm:ss")),1)])),_:2},1024)])),_:2},1024),i(a,{class:"detail-row"},{default:c((()=>[i(x,{name:"check",size:32,color:"#999"}),i(l,{class:"detail-label"},{default:c((()=>[u("ç­¾åˆ°æ–¹å¼")])),_:1}),i(l,{class:"detail-value"},{default:c((()=>{return[u(n((s=e.method,{CODE:"ç­¾åˆ°ç ",QRCODE:"äºŒç»´ç ",MAKEUP:"è¡¥ç­¾"}[s]||"æœªçŸ¥")),1)];var s})),_:2},1024)])),_:2},1024),i(a,{class:"detail-row"},{default:c((()=>[i(x,{name:"order",size:32,color:"#999"}),i(l,{class:"detail-label"},{default:c((()=>[u("ç­¾åˆ°ç ")])),_:1}),i(l,{class:"detail-value code"},{default:c((()=>[u(n(e.code),1)])),_:2},1024)])),_:2},1024)],64)),i(a,{class:"detail-row session-time"},{default:c((()=>[i(x,{name:"calendar",size:32,color:"#999"}),i(l,{class:"detail-label"},{default:c((()=>[u("ä¼šè¯æ—¶é—´")])),_:1}),i(l,{class:"detail-value small"},{default:c((()=>[u(n(g(k)(e.sessionStartTime,"YYYY-MM-DD HH:mm")),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1}),D.value||0!==L.value.length?_("",!0):(o(),t(w,{key:1,text:"æš‚æ— ç­¾åˆ°è®°å½•",icon:"calendar"})),D.value?(o(),t(a,{key:2,class:"loading-container"},{default:c((()=>[i(l,{class:"loading-text"},{default:c((()=>[u("åŠ è½½ä¸­...")])),_:1})])),_:1})):_("",!0)])),_:1})}}},[["__scopeId","data-v-cd76ce9a"]]);export{z as default};
