import{J as e,K as a,z as l,d as t,c as s,w as u,h as d,F as o,j as i,e as n,v as c,k as m,q as f,i as v,r,B as _,C as g,X as p,m as h,D as b,t as V,a9 as z,ae as y,p as I,af as k,T as w}from"./index-BA-OeFd4.js";import{_ as U}from"./_plugin-vue_export-helper.BCo6x5W8.js";const x=U({__name:"rating-star",props:{modelValue:{type:Number,default:0},max:{type:Number,default:5},size:{type:String,default:"normal"},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:a}){const r=e,_=a,g=l((()=>Array.from({length:r.max})));return(a,l)=>{const p=f,h=v;return t(),s(h,{class:c(["rating-star",[`size-${e.size}`]])},{default:u((()=>[(t(!0),d(o,null,i(g.value,((a,l)=>(t(),s(h,{key:l,class:"star-item",onClick:e=>{return a=l+1,void(r.disabled||(_("update:modelValue",a),_("change",a)));var a}},{default:u((()=>[n(p,{class:c(["star-icon",{active:l<e.modelValue}])},{default:u((()=>[m("â˜…")])),_:2},1032,["class"])])),_:2},1032,["onClick"])))),128))])),_:1},8,["class"])}}},[["__scopeId","data-v-b856b4b2"]]),C=U({__name:"create",setup(i){const c=r(""),U=r(""),C=r(!1),M=r(""),N=r({title:"",coverImage:"",teacherName:""}),j=r({attitude1:0,attitude2:0,content1:0,content2:0,method1:0,method2:0,effect1:0,effect2:0,organization:0,suggestion:""}),B=r(!1),F=l((()=>j.value.attitude1>0||j.value.attitude2>0||j.value.content1>0||j.value.content2>0||j.value.method1>0||j.value.method2>0||j.value.effect1>0||j.value.effect2>0||j.value.organization>0));_((async e=>{c.value=e.courseId,U.value=e.chapterId||"",C.value="true"===e.viewMode||!0===e.viewMode,console.log("ğŸ“ è¯„ä»·é¡µé¢å‚æ•°:",{courseId:c.value,chapterId:U.value,viewMode:C.value}),await S(),C.value&&await T()}));const S=async()=>{try{g({title:"åŠ è½½ä¸­..."});const e=await p(c.value);N.value=e}catch(e){h({title:e.msg||"åŠ è½½å¤±è´¥",icon:"none"})}finally{b()}},T=async()=>{try{g({title:"åŠ è½½è¯„ä»·..."});const a=U.value&&""!==U.value.trim()?U.value:null,l=await function(a,l=null){const t=`/api/evaluations/course/${a}/my`;return l&&""!==l.trim()?e(t,{chapterId:l}):e(t)}(c.value,a);l&&(j.value={attitude1:l.attitude1||0,attitude2:l.attitude2||0,content1:l.content1||0,content2:l.content2||0,method1:l.method1||0,method2:l.method2||0,effect1:l.effect1||0,effect2:l.effect2||0,organization:l.organization||0,suggestion:l.suggestion||""},M.value=l.id)}catch(a){console.error("âŒ åŠ è½½è¯„ä»·å¤±è´¥:",a),h({title:a.msg||"åŠ è½½è¯„ä»·å¤±è´¥",icon:"none"})}finally{b()}},$=async()=>{if(F.value)try{B.value=!0;const e=[j.value.attitude1,j.value.attitude2,j.value.content1,j.value.content2,j.value.method1,j.value.method2,j.value.effect1,j.value.effect2,j.value.organization].filter((e=>e>0)),l=e.length>0?Math.round(e.reduce(((e,a)=>e+a),0)/e.length):0,t={courseId:c.value,rating:l,attitude1:j.value.attitude1,attitude2:j.value.attitude2,content1:j.value.content1,content2:j.value.content2,method1:j.value.method1,method2:j.value.method2,effect1:j.value.effect1,effect2:j.value.effect2,organization:j.value.organization,suggestion:j.value.suggestion};U.value&&(t.chapterId=U.value),console.log("ğŸ“ æäº¤è¯„ä»·æ•°æ®:",t),await function(e){return a("/api/evaluations",e)}(t),h({title:"è¯„ä»·æˆåŠŸ",icon:"success",duration:2e3}),setTimeout((()=>{z({success:()=>{y("evaluationSubmitted")}})}),2e3)}catch(e){h({title:e.msg||"è¯„ä»·å¤±è´¥",icon:"none"})}finally{B.value=!1}else h({title:"è¯·è‡³å°‘å®Œæˆä¸€é¡¹è¯„ä»·",icon:"none"})},q=()=>{z()};return(e,a)=>{const l=I,i=f,c=v,r=k,_=w;return t(),s(c,{class:"page"},{default:u((()=>[n(c,{class:"course-card"},{default:u((()=>[n(l,{src:N.value.coverImage,class:"cover",mode:"aspectFill"},null,8,["src"]),n(c,{class:"course-info"},{default:u((()=>[n(i,{class:"title"},{default:u((()=>[m(V(N.value.title),1)])),_:1}),n(i,{class:"teacher"},{default:u((()=>[m("è®²å¸ˆï¼š"+V(N.value.teacherName),1)])),_:1})])),_:1})])),_:1}),n(c,{class:"evaluation-form"},{default:u((()=>[n(c,{class:"form-title"},{default:u((()=>[m(V(C.value?"æˆ‘çš„è¯„ä»·":"è¯¾ç¨‹è¯„ä»·"),1)])),_:1}),n(c,{class:"form-section"},{default:u((()=>[n(c,{class:"section-title"},{default:u((()=>[m("æ•™å­¦æ€åº¦")])),_:1}),n(c,{class:"rating-item"},{default:u((()=>[n(c,{class:"item-desc"},{default:u((()=>[m("è€å¸ˆæ•™å­¦æŠ•å…¥ã€æœ‰æ¿€æƒ…")])),_:1}),n(x,{modelValue:j.value.attitude1,"onUpdate:modelValue":a[0]||(a[0]=e=>j.value.attitude1=e),disabled:C.value,size:"small"},null,8,["modelValue","disabled"])])),_:1}),n(c,{class:"rating-item"},{default:u((()=>[n(c,{class:"item-desc"},{default:u((()=>[m("è€å¸ˆæ•™å­¦è®¤çœŸã€è€å¿ƒã€è¯šæ³ã€å‹å¥½")])),_:1}),n(x,{modelValue:j.value.attitude2,"onUpdate:modelValue":a[1]||(a[1]=e=>j.value.attitude2=e),disabled:C.value,size:"small"},null,8,["modelValue","disabled"])])),_:1})])),_:1}),n(c,{class:"form-section"},{default:u((()=>[n(c,{class:"section-title"},{default:u((()=>[m("æ•™å­¦å†…å®¹")])),_:1}),n(c,{class:"rating-item"},{default:u((()=>[n(c,{class:"item-desc"},{default:u((()=>[m("è¯¾ç¨‹ä¸»é¢˜æ˜æ™°ï¼Œå†…å®¹æ¸…æ™°ï¼Œè®ºè¯ä¸¥å¯†")])),_:1}),n(x,{modelValue:j.value.content1,"onUpdate:modelValue":a[2]||(a[2]=e=>j.value.content1=e),disabled:C.value,size:"small"},null,8,["modelValue","disabled"])])),_:1}),n(c,{class:"rating-item"},{default:u((()=>[n(c,{class:"item-desc"},{default:u((()=>[m("è¯¾ç¨‹å†…å®¹å®è·µæ€§å¼ºï¼Œæ¡ˆä¾‹ä¸°å¯Œ")])),_:1}),n(x,{modelValue:j.value.content2,"onUpdate:modelValue":a[3]||(a[3]=e=>j.value.content2=e),disabled:C.value,size:"small"},null,8,["modelValue","disabled"])])),_:1})])),_:1}),n(c,{class:"form-section"},{default:u((()=>[n(c,{class:"section-title"},{default:u((()=>[m("æ•™å­¦æ–¹æ³•")])),_:1}),n(c,{class:"rating-item"},{default:u((()=>[n(c,{class:"item-desc"},{default:u((()=>[m("æ•™å­¦æ–¹æ³•å¾—å½“ï¼šé€»è¾‘æ€§å¼ºï¼Œæ¡ç†æ¸…æ™°ï¼Œé‡ç‚¹çªå‡º")])),_:1}),n(x,{modelValue:j.value.method1,"onUpdate:modelValue":a[4]||(a[4]=e=>j.value.method1=e),disabled:C.value,size:"small"},null,8,["modelValue","disabled"])])),_:1}),n(c,{class:"rating-item"},{default:u((()=>[n(c,{class:"item-desc"},{default:u((()=>[m("æ•™å­¦å¯¹é—®é¢˜çš„é˜ææ€§å¼º")])),_:1}),n(x,{modelValue:j.value.method2,"onUpdate:modelValue":a[5]||(a[5]=e=>j.value.method2=e),disabled:C.value,size:"small"},null,8,["modelValue","disabled"])])),_:1})])),_:1}),n(c,{class:"form-section"},{default:u((()=>[n(c,{class:"section-title"},{default:u((()=>[m("æ•™å­¦æ•ˆæœ")])),_:1}),n(c,{class:"rating-item"},{default:u((()=>[n(c,{class:"item-desc"},{default:u((()=>[m("è¾¾åˆ°é¢„æœŸè¦æ±‚ï¼Œå­¦ä¹ æœ‰æ•ˆï¼Œå¯¹å·¥ä½œæˆ–æˆé•¿æä¾›å¸®åŠ©")])),_:1}),n(x,{modelValue:j.value.effect1,"onUpdate:modelValue":a[6]||(a[6]=e=>j.value.effect1=e),disabled:C.value,size:"small"},null,8,["modelValue","disabled"])])),_:1}),n(c,{class:"rating-item"},{default:u((()=>[n(c,{class:"item-desc"},{default:u((()=>[m("å­¦ä¹ äº†æŒæ¡æ–°æ€æƒ³æˆ–æ–°æŠ€èƒ½")])),_:1}),n(x,{modelValue:j.value.effect2,"onUpdate:modelValue":a[7]||(a[7]=e=>j.value.effect2=e),disabled:C.value,size:"small"},null,8,["modelValue","disabled"])])),_:1})])),_:1}),n(c,{class:"form-section"},{default:u((()=>[n(c,{class:"section-title"},{default:u((()=>[m("æ•™åŠ¡ç»„ç»‡")])),_:1}),n(c,{class:"rating-item"},{default:u((()=>[n(c,{class:"item-desc"},{default:u((()=>[m("æ•™å­¦è¯¾ç¨‹èµ„æ–™å‡†å¤‡å……åˆ†")])),_:1}),n(x,{modelValue:j.value.organization,"onUpdate:modelValue":a[8]||(a[8]=e=>j.value.organization=e),disabled:C.value,size:"small"},null,8,["modelValue","disabled"])])),_:1})])),_:1}),n(c,{class:"form-section"},{default:u((()=>[n(c,{class:"section-title"},{default:u((()=>[m("æ‚¨å¯¹æœ¬æ¬¡è¯¾ç¨‹çš„å»ºè®®")])),_:1}),n(r,{modelValue:j.value.suggestion,"onUpdate:modelValue":a[9]||(a[9]=e=>j.value.suggestion=e),disabled:C.value,class:"suggestion-input",placeholder:"è¯·è¾“å…¥æ‚¨çš„å»ºè®®å’Œæ„è§ï¼ˆé€‰å¡«ï¼‰",maxlength:"500","show-confirm-bar":!1},null,8,["modelValue","disabled"]),n(c,{class:"char-count"},{default:u((()=>[m(V(j.value.suggestion.length)+"/500",1)])),_:1})])),_:1})])),_:1}),n(c,{class:"tip-section"},{default:u((()=>[n(c,{class:"tip-title"},{default:u((()=>[m("æ¸©é¦¨æç¤º")])),_:1}),n(c,{class:"tip-item"},{default:u((()=>[n(i,{class:"icon"},{default:u((()=>[m("â­")])),_:1}),n(i,{class:"text"},{default:u((()=>[m("æ¯é¡¹è¯„ä»·æ»¡åˆ†10åˆ†ï¼Œæ‚¨çš„è¯„ä»·å°†å¸®åŠ©æˆ‘ä»¬æ”¹è¿›è¯¾ç¨‹è´¨é‡")])),_:1})])),_:1}),n(c,{class:"tip-item"},{default:u((()=>[n(i,{class:"icon"},{default:u((()=>[m("ğŸ“„")])),_:1}),n(i,{class:"text"},{default:u((()=>[m("è¯„ä»·å®Œæˆåå³å¯ä¸‹è½½è¯¾ä»¶èµ„æ–™")])),_:1})])),_:1})])),_:1}),n(c,{class:"footer"},{default:u((()=>[C.value?(t(),s(_,{key:0,class:"btn-back",onClick:q},{default:u((()=>[m("è¿”å›")])),_:1})):(t(),d(o,{key:1},[n(_,{class:"btn-cancel",onClick:q},{default:u((()=>[m("å–æ¶ˆ")])),_:1}),n(_,{class:"btn-submit",onClick:$,loading:B.value,disabled:!F.value},{default:u((()=>[m(" æäº¤è¯„ä»· ")])),_:1},8,["loading","disabled"])],64))])),_:1})])),_:1})}}},[["__scopeId","data-v-df78a1ab"]]);export{C as default};
