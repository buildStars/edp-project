import{r as a,B as e,a3 as s,m as l,c as t,w as u,i as c,d as o,e as r,h as i,j as n,F as d,k as f,f as v,p as _,q as m,v as p,t as y,H as E,N as g,C as b,D as k,T as w}from"./index-BA-OeFd4.js";import{_ as D}from"./empty.CQuSoWib.js";import{g as N,a as P}from"./refund-request.BX8gY5J1.js";import{f as h}from"./util.SBHl27LX.js";import{_ as C}from"./_plugin-vue_export-helper.BCo6x5W8.js";const j=C({__name:"list",setup(C){const j=[{label:"全部",value:""},{label:"待审批",value:"PENDING"},{label:"已通过",value:"APPROVED"},{label:"已拒绝",value:"REJECTED"}],A=a(""),I=a([]),R=a(!1);e((()=>{x()})),s((()=>{x()}));const x=async()=>{try{R.value=!0;const a={page:1,pageSize:50};A.value&&(a.status=A.value);const e=await N(a);I.value=e.list||[],R.value=!1}catch(a){R.value=!1,l({title:a.msg||"加载失败",icon:"none"})}},G=a=>({PENDING:"待审批",APPROVED:"已通过",REJECTED:"已拒绝"}[a]||a);return(a,e)=>{const s=c,N=_,C=m,T=w;return o(),t(s,{class:"page"},{default:u((()=>[r(s,{class:"tabs"},{default:u((()=>[(o(),i(d,null,n(j,(a=>r(s,{key:a.value,class:p(["tab",{active:A.value===a.value}]),onClick:e=>{return s=a.value,A.value=s,void x();var s}},{default:u((()=>[f(y(a.label),1)])),_:2},1032,["class","onClick"]))),64))])),_:1}),r(s,{class:"list"},{default:u((()=>[(o(!0),i(d,null,n(I.value,(a=>(o(),t(s,{key:a.id,class:"item"},{default:u((()=>[r(N,{src:a.course.coverImage,class:"cover",mode:"aspectFill"},null,8,["src"]),r(s,{class:"content"},{default:u((()=>[r(C,{class:"course-name"},{default:u((()=>[f(y(a.course.title),1)])),_:2},1024),r(s,{class:"info-row"},{default:u((()=>[r(C,{class:"label"},{default:u((()=>[f("退回学分：")])),_:1}),r(C,{class:"value highlight"},{default:u((()=>[f(y(a.creditAmount),1)])),_:2},1024)])),_:2},1024),r(s,{class:"info-row"},{default:u((()=>[r(C,{class:"label"},{default:u((()=>[f("申请时间：")])),_:1}),r(C,{class:"value"},{default:u((()=>[f(y(E(h)(a.createdAt)),1)])),_:2},1024)])),_:2},1024),a.reason?(o(),t(s,{key:0,class:"info-row"},{default:u((()=>[r(C,{class:"label"},{default:u((()=>[f("退课原因：")])),_:1}),r(C,{class:"value"},{default:u((()=>[f(y(a.reason),1)])),_:2},1024)])),_:2},1024)):v("",!0),r(s,{class:"status-row"},{default:u((()=>{return[r(C,{class:p(["status-tag",(e=a.status,{PENDING:"pending",APPROVED:"approved",REJECTED:"rejected"}[e]||"")])},{default:u((()=>[f(y(G(a.status)),1)])),_:2},1032,["class"]),a.reviewedAt?(o(),t(C,{key:0,class:"review-time"},{default:u((()=>[f(y(E(h)(a.reviewedAt)),1)])),_:2},1024)):v("",!0)];var e})),_:2},1024),a.reviewNote?(o(),t(s,{key:1,class:"note"},{default:u((()=>[r(C,{class:"note-label"},{default:u((()=>[f("备注：")])),_:1}),r(C,{class:"note-text"},{default:u((()=>[f(y(a.reviewNote),1)])),_:2},1024)])),_:2},1024)):v("",!0)])),_:2},1024),"PENDING"===a.status?(o(),t(s,{key:0,class:"actions"},{default:u((()=>[r(T,{class:"btn-cancel",onClick:e=>{return s=a.id,void g({title:"确认取消",content:"确定要取消退课申请吗？",success:async a=>{if(a.confirm)try{b({title:"取消中..."}),await P(s),k(),l({title:"已取消",icon:"success"}),x()}catch(e){k(),l({title:e.msg||"取消失败",icon:"none"})}}});var s}},{default:u((()=>[f("取消申请")])),_:2},1032,["onClick"])])),_:2},1024)):v("",!0)])),_:2},1024)))),128)),R.value||0!==I.value.length?v("",!0):(o(),t(s,{key:0,class:"empty"},{default:u((()=>[r(N,{src:D,class:"empty-img",mode:"aspectFit"}),r(C,{class:"empty-text"},{default:u((()=>[f("暂无退课申请")])),_:1})])),_:1}))])),_:1}),R.value?(o(),t(s,{key:0,class:"loading"},{default:u((()=>[r(C,null,{default:u((()=>[f("加载中...")])),_:1})])),_:1})):v("",!0)])),_:1})}}},[["__scopeId","data-v-a896bddf"]]);export{j as default};
