import{r as a,G as e,N as s,x as l,c as t,w as u,i as c,d as o,e as r,h as i,j as n,F as d,k as f,f as v,y as _,z as m,A as p,t as y,L as E,Q as g,H as k,I as b,R as w}from"./index-Cljxm-NV.js";import{_ as N}from"./empty.Dy77HuBL.js";import{g as D,a as P}from"./refund-request.CBYMOx7x.js";import{f as h}from"./util.DiFpgDCN.js";import{_ as A}from"./_plugin-vue_export-helper.BCo6x5W8.js";const j=A({__name:"list",setup(A){const j=[{label:"全部",value:""},{label:"待审批",value:"PENDING"},{label:"已通过",value:"APPROVED"},{label:"已拒绝",value:"REJECTED"}],C=a(""),I=a([]),R=a(!1);e((()=>{x()})),s((()=>{x()}));const x=async()=>{try{R.value=!0;const a={page:1,pageSize:50};C.value&&(a.status=C.value);const e=await D(a);I.value=e.list||[],R.value=!1}catch(a){R.value=!1,l({title:a.msg||"加载失败",icon:"none"})}},G=a=>({PENDING:"待审批",APPROVED:"已通过",REJECTED:"已拒绝"}[a]||a);return(a,e)=>{const s=c,D=_,A=m,F=w;return o(),t(s,{class:"page"},{default:u((()=>[r(s,{class:"tabs"},{default:u((()=>[(o(),i(d,null,n(j,(a=>r(s,{key:a.value,class:p(["tab",{active:C.value===a.value}]),onClick:e=>{return s=a.value,C.value=s,void x();var s}},{default:u((()=>[f(y(a.label),1)])),_:2},1032,["class","onClick"]))),64))])),_:1}),r(s,{class:"list"},{default:u((()=>[(o(!0),i(d,null,n(I.value,(a=>(o(),t(s,{key:a.id,class:"item"},{default:u((()=>[r(D,{src:a.course.coverImage,class:"cover",mode:"aspectFill"},null,8,["src"]),r(s,{class:"content"},{default:u((()=>[r(A,{class:"course-name"},{default:u((()=>[f(y(a.course.title),1)])),_:2},1024),r(s,{class:"info-row"},{default:u((()=>[r(A,{class:"label"},{default:u((()=>[f("退回学分：")])),_:1}),r(A,{class:"value highlight"},{default:u((()=>[f(y(a.creditAmount),1)])),_:2},1024)])),_:2},1024),r(s,{class:"info-row"},{default:u((()=>[r(A,{class:"label"},{default:u((()=>[f("申请时间：")])),_:1}),r(A,{class:"value"},{default:u((()=>[f(y(E(h)(a.createdAt)),1)])),_:2},1024)])),_:2},1024),a.reason?(o(),t(s,{key:0,class:"info-row"},{default:u((()=>[r(A,{class:"label"},{default:u((()=>[f("退课原因：")])),_:1}),r(A,{class:"value"},{default:u((()=>[f(y(a.reason),1)])),_:2},1024)])),_:2},1024)):v("",!0),r(s,{class:"status-row"},{default:u((()=>{return[r(A,{class:p(["status-tag",(e=a.status,{PENDING:"pending",APPROVED:"approved",REJECTED:"rejected"}[e]||"")])},{default:u((()=>[f(y(G(a.status)),1)])),_:2},1032,["class"]),a.reviewedAt?(o(),t(A,{key:0,class:"review-time"},{default:u((()=>[f(y(E(h)(a.reviewedAt)),1)])),_:2},1024)):v("",!0)];var e})),_:2},1024),a.reviewNote?(o(),t(s,{key:1,class:"note"},{default:u((()=>[r(A,{class:"note-label"},{default:u((()=>[f("备注：")])),_:1}),r(A,{class:"note-text"},{default:u((()=>[f(y(a.reviewNote),1)])),_:2},1024)])),_:2},1024)):v("",!0)])),_:2},1024),"PENDING"===a.status?(o(),t(s,{key:0,class:"actions"},{default:u((()=>[r(F,{class:"btn-cancel",onClick:e=>{return s=a.id,void g({title:"确认取消",content:"确定要取消退课申请吗？",success:async a=>{if(a.confirm)try{k({title:"取消中..."}),await P(s),b(),l({title:"已取消",icon:"success"}),x()}catch(e){b(),l({title:e.msg||"取消失败",icon:"none"})}}});var s}},{default:u((()=>[f("取消申请")])),_:2},1032,["onClick"])])),_:2},1024)):v("",!0)])),_:2},1024)))),128)),R.value||0!==I.value.length?v("",!0):(o(),t(s,{key:0,class:"empty"},{default:u((()=>[r(D,{src:N,class:"empty-img",mode:"aspectFit"}),r(A,{class:"empty-text"},{default:u((()=>[f("暂无退课申请")])),_:1})])),_:1}))])),_:1}),R.value?(o(),t(s,{key:0,class:"loading"},{default:u((()=>[r(A,null,{default:u((()=>[f("加载中...")])),_:1})])),_:1})):v("",!0)])),_:1})}}},[["__scopeId","data-v-c7167fd4"]]);export{j as default};
