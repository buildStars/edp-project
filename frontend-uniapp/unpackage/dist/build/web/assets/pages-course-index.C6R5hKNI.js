import{r as e,u as a,z as s,o as l,m as t,s as o,b as u,A as r,c as i,w as c,i as n,d,e as _,k as p,h as v,j as f,F as m,f as g,q as y,n as h,l as x}from"./index-BA-OeFd4.js";import{u as j}from"./course.CVoECnYr.js";import{C as k}from"./course-card.3HxFFqMZ.js";import{E as w}from"./empty-view.BTAzOfaH.js";import{_ as C}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./util.SBHl27LX.js";/* empty css                                                                    *//* empty css                                                                   */const L=C({__name:"index",setup(C){const L=e(!1),b=e(1),E=e(10),z=e(!0),F=j(),q=a(),A=s((()=>F.courseList));l((()=>{I(!0)}));const I=async(e=!1)=>{if(!L.value){L.value=!0,e&&(b.value=1,z.value=!0);try{const a={page:b.value,pageSize:E.value},s=await F.fetchCourseList(a);(s.items||s.data||s.list||[]).length<E.value&&(z.value=!1),b.value++}catch(a){console.error("加载课程失败：",a),t({title:"加载失败",icon:"none"})}finally{L.value=!1,e&&o()}}},M=()=>{F.clearCourseList(),I(!0)},N=e=>{x({url:`/pages/course/detail?id=${e.id}`})},O=e=>{q.checkLogin()&&N(e)};return u((()=>{M()})),r((()=>{z.value&&!L.value&&I(!1)})),(e,a)=>{const s=n,l=y;return d(),i(s,{class:"page"},{default:c((()=>[_(s,{class:"page-header-decoration"}),_(s,{class:"page-title"},{default:c((()=>[_(l,{class:"title-text"},{default:c((()=>[p("课程中心")])),_:1}),_(l,{class:"title-desc"},{default:c((()=>[p("精品课程 · 助力成长")])),_:1})])),_:1}),_(s,{class:"course-list"},{default:c((()=>[(d(!0),v(m,null,f(A.value,((e,a)=>(d(),i(s,{key:e.id,class:"course-item-wrapper",style:h({"animation-delay":.1*a+"s"})},{default:c((()=>[_(k,{course:e,onClick:N,onEnroll:O},null,8,["course"])])),_:2},1032,["style"])))),128)),L.value||0!==A.value.length?g("",!0):(d(),i(w,{key:0,text:"暂无课程","show-btn":!0,onClick:M})),L.value?(d(),i(s,{key:1,class:"loading-more"},{default:c((()=>[_(s,{class:"loading-spinner"}),_(l,{class:"loading-text"},{default:c((()=>[p("加载中...")])),_:1})])),_:1})):g("",!0),!z.value&&A.value.length>0?(d(),i(s,{key:2,class:"no-more"},{default:c((()=>[_(s,{class:"no-more-line"}),_(l,{class:"no-more-text"},{default:c((()=>[p("已经到底了")])),_:1}),_(s,{class:"no-more-line"})])),_:1})):g("",!0)])),_:1})])),_:1})}}},[["__scopeId","data-v-98fff552"]]);export{L as default};
