# ========================================
# uni-app Web/H5 é™æ€æ–‡ä»¶éƒ¨ç½²
# ========================================
# æ­¤é¡¹ç›®ä½¿ç”¨HBuilderXç‰¹å®šç‰ˆæœ¬ä¾èµ–ï¼Œæ— æ³•é€šè¿‡npmåœ¨Dockerä¸­å®‰è£…
# 
# éƒ¨ç½²å‰å¿…é¡»ï¼š
# 1. åœ¨æœ¬åœ°Windowsè¿è¡Œ: ./build-h5.bat
# 2. æˆ–åœ¨HBuilderXä¸­: å‘è¡Œ â†’ ç½‘ç«™-H5ç§»åŠ¨ç‰ˆ  
# 3. æäº¤æ„å»ºäº§ç‰©åˆ°git
# ========================================

FROM nginx:alpine

WORKDIR /usr/share/nginx/html

# å¤åˆ¶æœ¬åœ°æ„å»ºäº§ç‰©
# HBuilderX 4.67+è¾“å‡º: unpackage/dist/build/web/
# HBuilderX æ—§ç‰ˆè¾“å‡º: unpackage/dist/build/h5/
COPY unpackage/dist/build/web ./

# å¤åˆ¶Nginxé…ç½®
COPY nginx.conf /etc/nginx/conf.d/default.conf

# éªŒè¯æ„å»ºäº§ç‰©
RUN test -f "index.html" && echo "âœ… Webé™æ€æ–‡ä»¶å·²éƒ¨ç½²" && ls -lh || \
    (echo "âŒ é”™è¯¯ï¼šæœªæ‰¾åˆ°index.html" && \
     echo "ğŸ’¡ è¯·å…ˆè¿è¡Œ: ./build-h5.bat æˆ–åœ¨HBuilderXä¸­æ„å»º" && \
     echo "ğŸ’¡ ç„¶åæäº¤: git add -f frontend-uniapp/unpackage/dist/build/web/" && \
     exit 1)

EXPOSE 80

CMD ["nginx", "-g", "daemon off;"]

