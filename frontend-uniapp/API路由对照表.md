# API è·¯ç”±å¯¹ç…§è¡¨

## ğŸ” è®¤è¯æ¨¡å—ï¼ˆAuthï¼‰

| åŠŸèƒ½ | å‰ç«¯è°ƒç”¨ | åç«¯è·¯ç”± | çŠ¶æ€ |
|------|---------|---------|------|
| å¾®ä¿¡ç™»å½• | `wxLogin()` | `POST /api/auth/wx-login` | âœ… å·²ä¿®æ­£ |
| ç»‘å®šæ‰‹æœºå· | `bindPhone()` | `POST /api/auth/bind-phone` | âœ… å·²ä¿®æ­£ |
| è·å–ä¸ªäººèµ„æ–™ | - | `GET /api/auth/profile` | âš ï¸ å»ºè®®ä½¿ç”¨ `/api/user/info` |

---

## ğŸ‘¤ ç”¨æˆ·æ¨¡å—ï¼ˆUserï¼‰

| åŠŸèƒ½ | å‰ç«¯è°ƒç”¨ | åç«¯è·¯ç”± | çŠ¶æ€ |
|------|---------|---------|------|
| è·å–ç”¨æˆ·ä¿¡æ¯ | `getUserInfo()` | `GET /api/user/info` | âœ… |
| æ›´æ–°ç”¨æˆ·ä¿¡æ¯ | `updateUserInfo()` | `PUT /api/user/info` | âœ… |
| ä¸Šä¼ å¤´åƒ | - | `POST /api/user/upload-avatar` | âœ… |

**éœ€è¦è®¤è¯**ï¼šéœ€è¦åœ¨ Header ä¸­æºå¸¦ `Authorization: Bearer <token>`

---

## ğŸ“° èµ„è®¯æ¨¡å—ï¼ˆNewsï¼‰

| åŠŸèƒ½ | å‰ç«¯è°ƒç”¨ | åç«¯è·¯ç”± | çŠ¶æ€ |
|------|---------|---------|------|
| è·å–èµ„è®¯åˆ—è¡¨ | `getNewsList()` | `GET /api/news` | âœ… |
| è·å–èµ„è®¯è¯¦æƒ… | `getNewsDetail()` | `GET /api/news/:id` | âœ… |
| æ”¶è—èµ„è®¯ | `collectNews()` | `POST /api/news/collect` | âœ… |
| å–æ¶ˆæ”¶è— | `uncollectNews()` | `DELETE /api/news/collect?newsId=xxx` | âœ… |

---

## ğŸ“š è¯¾ç¨‹æ¨¡å—ï¼ˆCourseï¼‰

| åŠŸèƒ½ | å‰ç«¯è°ƒç”¨ | åç«¯è·¯ç”± | çŠ¶æ€ |
|------|---------|---------|------|
| è·å–è¯¾ç¨‹åˆ—è¡¨ | `getCourseList()` | `GET /api/courses` | âœ… |
| è·å–è¯¾ç¨‹è¯¦æƒ… | `getCourseDetail()` | `GET /api/courses/:id` | âœ… |
| æŠ¥åè¯¾ç¨‹ | `enrollCourse()` | `POST /api/courses/:id/enroll` | âœ… |
| è¯¾ç¨‹ç­¾åˆ° | `checkInCourse()` | `POST /api/courses/:id/check-in` | âœ… |
| è¯„ä»·è¯¾ç¨‹ | `rateCourse()` | `POST /api/courses/:id/rate` | âœ… |
| è·å–æˆ‘çš„è¯¾ç¨‹ | `getMyCourses()` | `GET /api/courses/my-courses` | âœ… |

---

## ğŸ‘¥ åä¼šæ¨¡å—ï¼ˆAssociationï¼‰

| åŠŸèƒ½ | å‰ç«¯è°ƒç”¨ | åç«¯è·¯ç”± | çŠ¶æ€ |
|------|---------|---------|------|
| è·å–åä¼šåˆ—è¡¨ | `getAssociationList()` | `GET /api/associations` | âœ… |
| è·å–åä¼šè¯¦æƒ… | `getAssociationDetail()` | `GET /api/associations/:id` | âœ… |
| è·å–æ´»åŠ¨åˆ—è¡¨ | `getActivityList()` | `GET /api/activities` | âœ… |
| è·å–æ´»åŠ¨è¯¦æƒ… | `getActivityDetail()` | `GET /api/activities/:id` | âœ… |
| ç‚¹èµæ´»åŠ¨ | `likeActivity()` | `POST /api/activities/like` | âœ… |
| å–æ¶ˆç‚¹èµ | `unlikeActivity()` | `DELETE /api/activities/like?activityId=xxx` | âœ… |

---

## ğŸ“ å­¦åˆ†æ¨¡å—ï¼ˆCreditsï¼‰

| åŠŸèƒ½ | å‰ç«¯è°ƒç”¨ | åç«¯è·¯ç”± | çŠ¶æ€ |
|------|---------|---------|------|
| è·å–å­¦åˆ†è®°å½• | - | `GET /api/credits` | âœ… |
| è·å–å­¦åˆ†ç»Ÿè®¡ | - | `GET /api/credits/statistics` | âœ… |

---

## ğŸ” æœç´¢æ¨¡å—ï¼ˆSearchï¼‰

| åŠŸèƒ½ | å‰ç«¯è°ƒç”¨ | åç«¯è·¯ç”± | çŠ¶æ€ |
|------|---------|---------|------|
| å…¨å±€æœç´¢ | `search()` | `GET /api/search` | âš ï¸ å¾…å®ç° |

---

## ğŸ“ æ–‡ä»¶ä¸Šä¼ 

| åŠŸèƒ½ | å‰ç«¯è°ƒç”¨ | åç«¯è·¯ç”± | çŠ¶æ€ |
|------|---------|---------|------|
| ä¸Šä¼ æ–‡ä»¶ | `upload()` | `POST /api/upload` | âš ï¸ å¾…ç¡®è®¤ |

---

## ğŸ”‘ è¯·æ±‚å¤´é…ç½®

### è®¤è¯è¯·æ±‚
```javascript
headers: {
  'Content-Type': 'application/json',
  'Authorization': 'Bearer <token>'
}
```

### æ–‡ä»¶ä¸Šä¼ 
```javascript
headers: {
  'Content-Type': 'multipart/form-data',
  'Authorization': 'Bearer <token>'
}
```

---

## ğŸ“ æ•°æ®æ ¼å¼

### æˆåŠŸå“åº”
```json
{
  "code": 200,
  "data": { ... },
  "msg": "success"
}
```

### é”™è¯¯å“åº”
```json
{
  "code": 400,
  "msg": "é”™è¯¯ä¿¡æ¯",
  "data": null,
  "timestamp": "2025-10-31T20:47:01.129Z"
}
```

---

## ğŸš¨ å¸¸è§é”™è¯¯ç 

| é”™è¯¯ç  | è¯´æ˜ | å¤„ç†æ–¹å¼ |
|--------|------|---------|
| 401 | æœªæˆæƒ/Tokenè¿‡æœŸ | è·³è½¬ç™»å½•é¡µ |
| 403 | æ— æƒé™ | æç¤ºç”¨æˆ·æƒé™ä¸è¶³ |
| 404 | æ¥å£ä¸å­˜åœ¨ | æ£€æŸ¥ API è·¯å¾„æ˜¯å¦æ­£ç¡® |
| 500 | æœåŠ¡å™¨é”™è¯¯ | æç¤ºç”¨æˆ·ç¨åé‡è¯• |

---

## âœ… å·²ä¿®æ­£çš„é—®é¢˜

### 1. å¾®ä¿¡ç™»å½•æ¥å£è·¯å¾„é”™è¯¯
**é”™è¯¯**ï¼š`POST /api/user/wx-login` âŒ  
**æ­£ç¡®**ï¼š`POST /api/auth/wx-login` âœ…

**ä¿®æ”¹æ–‡ä»¶**ï¼š`frontend-uniapp/api/user.js`

### 2. ç»‘å®šæ‰‹æœºå·æ¥å£è·¯å¾„é”™è¯¯
**é”™è¯¯**ï¼š`POST /api/user/bind-phone` âŒ  
**æ­£ç¡®**ï¼š`POST /api/auth/bind-phone` âœ…

**ä¿®æ”¹æ–‡ä»¶**ï¼š`frontend-uniapp/api/user.js`

---

## ğŸ“Š åç«¯è·¯ç”±æ¨¡å—å¯¹åº”å…³ç³»

```
/api/
â”œâ”€â”€ auth/               # è®¤è¯æ¨¡å—ï¼ˆç™»å½•ã€ç»‘å®šæ‰‹æœºç­‰ï¼‰
â”œâ”€â”€ user/              # ç”¨æˆ·ä¿¡æ¯æ¨¡å—
â”œâ”€â”€ news/              # èµ„è®¯æ¨¡å—
â”œâ”€â”€ courses/           # è¯¾ç¨‹æ¨¡å—
â”œâ”€â”€ associations/      # åä¼šæ¨¡å—
â”œâ”€â”€ activities/        # æ´»åŠ¨æ¨¡å—
â”œâ”€â”€ credits/           # å­¦åˆ†æ¨¡å—
â””â”€â”€ admin/             # ç®¡ç†åå°ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰
    â”œâ”€â”€ users/         # ç”¨æˆ·ç®¡ç†
    â”œâ”€â”€ courses/       # è¯¾ç¨‹ç®¡ç†
    â”œâ”€â”€ news/          # èµ„è®¯ç®¡ç†
    â””â”€â”€ ...
```

---

## ğŸ” å¦‚ä½•æŸ¥çœ‹å®Œæ•´ API æ–‡æ¡£

1. å¯åŠ¨åç«¯æœåŠ¡
2. è®¿é—® Swagger æ–‡æ¡£ï¼šhttp://localhost:3000/api/docs
3. æŸ¥çœ‹æ‰€æœ‰æ¥å£çš„è¯¦ç»†å‚æ•°å’Œè¿”å›å€¼

---

## âš™ï¸ å¼€å‘å»ºè®®

1. **ç»Ÿä¸€ä½¿ç”¨ `/api/auth/` å‰ç¼€** å¤„ç†è®¤è¯ç›¸å…³æ¥å£
2. **ç»Ÿä¸€ä½¿ç”¨ `/api/user/` å‰ç¼€** å¤„ç†ç”¨æˆ·ä¿¡æ¯æ¥å£
3. **æ‰€æœ‰éœ€è¦ç™»å½•çš„æ¥å£** éƒ½éœ€è¦æºå¸¦ `Authorization` å¤´
4. **é”™è¯¯å¤„ç†** å·²åœ¨ `request.js` ä¸­ç»Ÿä¸€å¤„ç†
5. **Token è¿‡æœŸ** ä¼šè‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µ

---

## ğŸ“ é‡åˆ° 404 é”™è¯¯ï¼Ÿ

æ£€æŸ¥æ¸…å•ï¼š
- [ ] åç«¯æœåŠ¡æ˜¯å¦å¯åŠ¨
- [ ] API è·¯å¾„æ˜¯å¦æ­£ç¡®ï¼ˆæ³¨æ„ `/auth/` vs `/user/`ï¼‰
- [ ] æ˜¯å¦æ·»åŠ äº† `/api` å‰ç¼€
- [ ] è¯·æ±‚æ–¹æ³•æ˜¯å¦æ­£ç¡®ï¼ˆGET/POST/PUT/DELETEï¼‰
- [ ] æ˜¯å¦éœ€è¦è®¤è¯ Token

---

æ›´æ–°æ—¶é—´ï¼š2025-10-31

